game.import("extension",function(lib,game,ui,get,ai,_status){return {name:"异界四国",content:function (config,pack){
    
},precontent:function (){
    
},help:{},config:{},package:{
    character:{
        character:{
            "嵇授获":["male","qun",4,["矢北","清弦","再起"],["des:沮授+嵇康+孟获"]],
            "刘恪":["male","shu",3,["享乐","天命","黩武"],["des:刘禅+刘协+诸葛恪"]],
            "刘攸":["male","shu",4,["战绝","智愚"],["des:刘谌+荀攸"]],
            "高宓":["male","qun",4,["陷阵","禁酒","天辩"],["des:高顺+泰宓"]],
            "吕羽":["male","qun",4,["无双","烈刃","天辩"],["des:吕布+关羽"]],
            "许蝉":["male","wei",4,["裸衣","闭月"],["des:界许褚+貂蝉"]],
            "马平":["male","shu",4,["马术","铁骑","龙吟"],["des:马超+关平"]],
            "华异":["male","qun",6,["耀武","贞烈"],["des:华雄+王异"]],
            "刘亮":["male","shu",4,["仁德","空城"],["des:刘备+诸葛亮"]],
            "沮康":["male","qun",3,["矢北","清弦"],["des:沮授+嵇康"]],
            "凌权":["male","wu",4,["旋风","制衡"],["des:凌统+孙权"]],
            "夏侯嘉":["male","wei",4,["刚烈","天妒"],["des:夏侯淳+郭嘉"]],
            "诸昏":["male","shu",3,["空城","极奢"],["des:诸葛亮+岑昏"]],
            "曹侯淳":["male","wei",4,["奸雄","刚烈"],["des:曹操+夏侯淳"]],
            "吕瑜":["male","wu",4,["克己","英姿"],["des:吕蒙+周瑜"]],
            "张芝":["male","qun",3,["雷击","鬼道","卫境"],["des:张角+鲁芝"]],
            "黄奉":["male","shu",4,["烈弓","奋迅","短兵"],["des:黄忠+丁奉"]],
            "典盖":["male","wei",4,["强袭","诈降"],["des:典韦+界黄盖"]],
            "太史宓":["male","wu",4,["天义","天辩"],["des:太史慈+泰宓"]],
            "祝宓":["female","shu",4,["巨象","烈刃","天辩"],["des:祝融+秦宓"]],
            "孟康":["male","qun",5,["再起","清弦"],["des:孟获+嵇康"]],
            "黄志":["male","wu",4,["苦肉","安国"],["des:黄盖+朱志"]],
            "孙华":["male","wu",4,["英魂","伤势"],["des:孙坚+张春华"]],
            "孙瑜慈":["male","wu",4,["激昂","英姿","天义","英魂"],["des:孙策+周瑜+太史慈"]],
            "甘逊":["male","wu",3,["奇袭","谦逊","连营"],["des:甘宁+陆逊"]],
            "董获":["male","qun",8,["肉林","崩坏","再起"],["des:董卓+孟获"]],
            "孙仁":["female","wu",3,["枭姬","据守","解围"],["des:孙尚香+曹仁"]],
            "吴义":["male","shu",4,["奔袭","伏骑","娇恣"],["des:吴懿+麹义"]],
            "荀睿":["male","wei",3,["奇策","恢拓"],["des:荀攸+曹叡"]],
            "夏侯昂":["male","shu",4,["豹变","慷忾"],["des:夏侯霸+曹昂"]],
            "袁华":["male","qun",4,["庸肆","伤势"],["des:袁术+张春华"]],
            "甄懿":["female","wei",3,["洛神","鬼才"],["des:甄姬+司马懿"]],
            "郭佗":["male","wei",3,["遗计","急救"],["des:郭嘉+华佗"]],
            "关松":["male","shu",4,["强识","龙吟"],["des:关平+张松"]],
            "魏羽":["male","shu",4,["狂骨","武圣","奇谋"],["des:魏延+关羽"]],
            "赵飞":["male","qun",4,["龙胆","冲阵","咆哮"],["des:赵云+张飞"]],
            "乐仁":["male","wei",4,["骁果","据守"],["des:乐进+曹仁"]],
            "曹智仁":["male","wei",3,["酒诗","据守","解围"],["des:曹植+曹仁"]],
            "貂仁":["female","qun",3,["离魂","据守"],["des:sp貂蝉+曹仁"]],
            "朱盖":["male","wei",4,["战意","诈降"],["des:朱灵+界黄盖"]],
            "王华":["female","wei",3,["贞烈","伤势"],["des:王异+张春华"]],
        },
        translate:{
            "嵇授获":"嵇授获",
            "刘恪":"刘恪",
            "刘攸":"刘攸",
            "高宓":"高宓",
            "吕羽":"吕羽",
            "许蝉":"许蝉",
            "马平":"马平",
            "华异":"华异",
            "刘亮":"刘亮",
            "沮康":"沮康",
            "凌权":"凌权",
            "夏侯嘉":"夏侯嘉",
            "诸昏":"诸昏",
            "曹侯淳":"曹侯淳",
            "吕瑜":"吕瑜",
            "张芝":"张芝",
            "黄奉":"黄奉",
            "典盖":"典盖",
            "太史宓":"太史宓",
            "祝宓":"祝宓",
            "孟康":"孟康",
            "黄志":"黄志",
            "孙华":"孙华",
            "孙瑜慈":"孙瑜慈",
            "甘逊":"甘逊",
            "董获":"董获",
            "孙仁":"孙仁",
            "吴义":"吴义",
            "荀睿":"荀睿",
            "夏侯昂":"夏侯昂",
            "袁华":"袁华",
            "甄懿":"甄懿",
            "郭佗":"郭佗",
            "关松":"关松",
            "魏羽":"魏羽",
            "赵飞":"赵飞",
            "乐仁":"乐仁",
            "曹智仁":"曹智仁",
            "貂仁":"貂仁",
            "朱盖":"朱盖",
            "王华":"王华",
        },
    },
    card:{
        card:{
        },
        translate:{
        },
        list:[],
    },
    skill:{
        skill:{
            "诈降":{
                init:function (player){
    player.storage.ol_zhaxiang=0;
    },
                group:"ol_zhaxiang_reset",
                trigger:{
                    player:"loseHpEnd",
                },
                marktext:"降",
                intro:{
                    content:function (storage){
            
            return '本回合已发动过'+storage+'次诈降';
        },
                },
                forced:true,
                filter:function (event){
        return (event.num>0)
    },
                content:function (){
        player.draw(3*trigger.num);
  
        if(_status.currentPhase==player){
             
            player.addTempSkill('ol_zhaxiang_sha',{player:'phaseUseEnd'});
            player.markSkill('ol_zhaxiang');
            player.storage.ol_zhaxiang+=trigger.num;
        }
        else{
            game.trySkillAudio('zhaxiang',player);
        }
    },
                subSkill:{
                    sha:{
                        audio:"zhaxiang",
                        trigger:{
                            player:"shaBegin",
                        },
                        forced:true,
                        filter:function (event,player){
                return event.card&&get.color(event.card)=='red';
            },
                        content:function (){
                trigger.directHit=true;  
                
            },
                        mod:{
                            targetInRange:function (card,player,target,now){
                    if(card.name=='sha'&&get.color(card)=='red') return true;
                },
                            cardUsable:function (card,player,num){
                    if(card.name=='sha') return num+player.storage.ol_zhaxiang;
                },
                        },
                        sub:true,
                    },
                    reset:{
                        trigger:{
                            player:"phaseUseEnd",
                        },
                        forced:true,
                        popup:false,
                        silent:true,
                        content:function (){
       player.storage.ol_zhaxiang=0;
      player.unmarkSkill('ol_zhaxiang');
           player.update();
           ui.clear();
             },
                        sub:true,
                    },
                },
            },
            "强袭":{
                audio:"qiangxi",
                enable:"phaseUse",
                filter:function (event,player){
        if(player.hasSkill('xinqiangxi2')){
            return !player.hasSkill('xinqiangxi3');
        }
        else if(player.hasSkill('xinqiangxi3')){
            return !player.hasSkill('xinqiangxi2')&&player.countCards('he',{type:'equip'})>0;
        }
        else{
            return true;
        }
    },
                filterCard:function (card){
        var player=_status.event.player;
        if(player.hasSkill('xinqiangxi2')) return false;
        return get.type(card)=='equip';
    },
                selectCard:function (){
        var player=_status.event.player;
        if(player.hasSkill('xinqiangxi2')) return -1;
        if(player.hasSkill('xinqiangxi3')) return [1,1];
        return [0,1];
    },
                filterTarget:function (card,player,target){
        if(player==target) return false;
        return get.distance(player,target,'attack')<=1;
    },
                content:function (){
        "step 0"
        if(cards.length==0){
            player.loseHp();
            player.addTempSkill('xinqiangxi3');
        }
        else{
            player.addTempSkill('xinqiangxi2');
        }
        "step 1"
        target.damage();
    },
                check:function (card){
        return 10-get.value(card);
    },
                position:"he",
                ai:{
                    order:8.5,
                    result:{
                        target:function (player,target){
                if(player.hasSkill('xinqiangxi2')||!player.countCards('he',{type:'equip'})){
                    if(player.hp<2) return 0;
                    if(target.hp>=player.hp) return 0;
                }
                return get.damageEffect(target,player);
            },
                    },
                },
                threaten:1.5,
            },
            "连营":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"loseEnd",
                },
                direct:true,
                filter:function (event,player){
        if(player.countCards('h')) return false;
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='h') return true;
        }
        return false;
    },
                content:function (){
        "step 0"
        var num=0;
        for(var i=0;i<trigger.cards.length;i++){
            if(trigger.cards[i].original=='h') num++;
        }
        player.chooseTarget('选择发动连营的目标',[1,num]).ai=function(target){
            var player=_status.event.player;
            if(player==target) return get.attitude(player,target)+10;
            return get.attitude(player,target);
        }
        "step 1"
        if(result.bool){
            player.logSkill('relianying',result.targets);
            game.asyncDraw(result.targets);
        }
    },
                ai:{
                    threaten:0.8,
                    effect:{
                        target:function (card){
                if(card.name=='guohe'||card.name=='liuxinghuoyu') return 0.5;
            },
                    },
                    noh:true,
                },
            },
            "谦逊":{
                init:function (player){
        player.storage.reqianxun2=[];
    },
                audio:"ext:异界四国:2",
                trigger:{
                    target:"useCardToBegin",
                    player:"judgeBefore",
                },
                filter:function (event,player){
        if(player.countCards('h')==0) return false;
        if(event.parent.name=='phaseJudge'){
            if(lib.skill.reqianxun.trigger.player=='judgeBefore'){
                return true;
            }
            return event.result&&event.result.judge!=0;
        }
        if(event.name=='judge') return false;
        if(event.targets&&event.targets.length>1) return false;
        if(event.card&&get.type(event.card)=='trick'&&event.player!=player) return true;
    },
                content:function (){
        player.storage.reqianxun2=player.storage.reqianxun2.concat(player.getCards('h'));
        game.addVideo('storage',player,['reqianxun2',get.cardsInfo(player.storage.reqianxun2),'cards']);
        player.lose(player.getCards('h'),ui.special);
        player.addSkill('reqianxun2');
    },
                ai:{
                    effect:function (card,player,target){
            if(!target.hasFriend()) return;
            if(player==target) return;
            var type=get.type(card);
            var nh=target.countCards();
            if(type=='trick'){
                if(!get.tag(card,'multitarget')||get.info(card).singleCard){
                    if(get.tag(card,'damage')){
                        if(nh<3||target.hp<=2) return 0.8;
                    }
                    return [1,nh];
                }
            }
            else if(type=='delay'){
                return [0.5,0.5];
            }
        },
                },
            },
            "青囊":{
                audio:"ext:异界四国:2",
                enable:"phaseUse",
                filterCard:true,
                usable:1,
                check:function (card){
        return 9-get.value(card)
    },
                filterTarget:function (card,player,target){
        if(target.hp>=target.maxHp) return false;
        return true;
    },
                content:function (){
        target.recover();
    },
                ai:{
                    order:9,
                    result:{
                        target:function (player,target){
                if(target.hp==1) return 5;
                if(player==target&&player.countCards('h')>player.hp) return 5;
                return 2;
            },
                    },
                    threaten:2,
                },
            },
            "急救":{
                audio:"ext:异界四国:2",
                enable:"chooseToUse",
                filter:function (event,player){
        return _status.currentPhase!=player;
    },
                filterCard:function (card){
        return get.color(card)=='red';
    },
                position:"he",
                viewAs:{
                    name:"tao",
                },
                prompt:"将一张红色牌当桃使用",
                check:function (card){return 15-get.value(card)},
                ai:{
                    skillTagFilter:function (player){
            return player.countCards('he',{color:'red'})>0&&_status.currentPhase!=player;
        },
                    threaten:1.5,
                    save:true,
                    respondTao:true,
                    basic:{
                        order:function (card,player){
                            if(player.hasSkillTag('pretao')) return 5;
                            return 2;
                        },
                        useful:[8,6.5,5,4],
                        value:[8,6.5,5,4],
                    },
                    result:{
                        target:function (player,target){
                            // if(player==target&&player.hp<=0) return 2;
                            var nd=player.needsToDiscard();
                            var keep=false;
                            if(nd<=0){
                                keep=true;
                            }
                            else if(nd==1&&target.hp>=2&&target.countCards('h','tao')<=1){
                                keep=true;
                            }
                            var mode=get.mode();
                            if(target.hp>=2&&keep&&target.hasFriend()){
                                if(target.hp>2||nd==0) return 0;
                                if(target.hp==2){
                                    if(game.hasPlayer(function(current){
                                        if(target!=current&&get.attitude(target,current)>=3){
                                            if(current.hp<=1) return true;
                                            if((mode=='identity'||mode=='versus'||mode=='chess')&&current.identity=='zhu'&&current.hp<=2) return true;
                                        }
                                    })){
                                        return 0;
                                    }
                                }
                            }
                            if(target.hp<0&&target!=player&&target.identity!='zhu') return 0;
                            var att=get.attitude(player,target);
                            if(att<3&&att>=0&&player!=target) return 0;
                            var tri=_status.event.getTrigger();
                            if(mode=='identity'&&player.identity=='fan'&&target.identity=='fan'){
                                if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='fan'&&tri.source!=target){
                                    var num=game.countPlayer(function(current){
                                        if(current.identity=='fan'){
                                            return current.countCards('h','tao');
                                        }
                                    });
                                    if(num>1&&player==target) return 2;
                                    return 0;
                                }
                            }
                            if(mode=='identity'&&player.identity=='zhu'&&target.identity=='nei'){
                                if(tri&&tri.name=='dying'&&tri.source&&tri.source.identity=='zhong'){
                                    return 0;
                                }
                            }
                            if(mode=='stone'&&target.isMin()&&
                            player!=target&&tri&&tri.name=='dying'&&player.side==target.side&&
                            tri.source!=target.getEnemy()){
                                return 0;
                            }
                            return 2;
                        },
                    },
                    tag:{
                        recover:1,
                        save:1,
                    },
                },
            },
            "苦肉":{
                audio:"ext:异界四国:4",
                enable:"phaseUse",
                prompt:"失去一点体力并摸两张牌",
                content:function (){
        "step 0"
        player.loseHp(1);
        "step 1"
        player.draw(2);
    },
                ai:{
                    basic:{
                        order:1,
                    },
                    result:{
                        player:function (player){
                if(player.countCards('h')>=player.hp-1) return -1;
                if(player.hp<3) return -1;
                return 1;
            },
                    },
                },
            },
            "龙吟":{
                trigger:{
                    global:"shaBegin",
                },
                direct:true,
                filter:function (event,player){
        return event.target==event.targets[0]&&player.countCards('he')>0&&event.card.name=='sha'&&
        _status.currentPhase==event.player&&event.parent.parent.parent.name=='phaseUse';
    },
                content:function (){
        'step 0'
        var go=false;
        if(get.attitude(player,trigger.player)>0){
            if(get.color(trigger.card)=='red'){
                go=true;
            }
            else if(!trigger.player.hasSkill('paoxiao')&&
                !trigger.player.hasSkill('tanlin3')&&
                !trigger.player.hasSkill('zhaxiang2')&&
                !trigger.player.hasSkill('fengnu')&&
                !trigger.player.getEquip('zhuge')){
                var nh=trigger.player.countCards('h');
                if(player==trigger.player){
                    go=(player.countCards('h','sha')>0);
                }
                else if(nh>=4){
                    go=true;
                }
                else if(player.countCards('h','sha')){
                    if(nh==3){
                        go=Math.random()<0.8;
                    }
                    else if(nh==2){
                        go=Math.random()<0.5;
                    }
                }
                else if(nh>=3){
                    if(nh==3){
                        go=Math.random()<0.5;
                    }
                    else if(nh==2){
                        go=Math.random()<0.2;
                    }
                }
            }
        }
        var next=player.chooseToDiscard(get.prompt('longyin'),'he');
        next.logSkill=['longyin',trigger.player];
        next.set('ai',function(card){
            if(_status.event.go){
                return 6-get.value(card);
            }
            return 0;
        });
        next.set('go',go);
        'step 1'
        if(result.bool){
            trigger.player.getStat().card.sha--;
            if(get.color(trigger.card)=='red'){
                player.draw();
            }
            // player.logSkill('longyin',trigger.player);
        }
    },
                ai:{
                    expose:0.2,
                },
            },
            "马术":{
                mod:{
                    globalFrom:function (from,to,distance){
            return distance-1;
        },
                },
            },
            "铁骑":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"shaBegin",
                },
                check:function (event,player){
        return get.attitude(player,event.target)<=0;
    },
                logTarget:"target",
                content:function (){
        "step 0"
        player.judge(function(card){
            if(get.zhu(_status.event.player,'shouyue')){
                if(get.suit(card)!='spade') return 2;
            }
            else{
                if(get.color(card)=='red') return 2;
            }
            return -0.5;
        });
        "step 1"
        if(result.bool){
            trigger.directHit=true;
        }
    },
            },
            "安国":{
                audio:"anguo",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        if(player==target) return false;
        if(player.isMinHandcard()||target.isMinHandcard()) return true;
        if(player.isMinEquip()||target.isMinEquip()) return true;
        if((player.isMinHp()&&player.isDamaged())||(target.isMinHp()&&target.isDamaged())) return true;
        return false;
    },
                content:function (){
        'step 0'
        if(target.isMinHandcard()){
            target.draw();
            event.h=true;
        }
        if(target.isMinHp()&&target.isDamaged()){
            target.recover();
            event.hp=true;
        }
        event.equip=get.cardPile(function(card){
            return get.type(card)=='equip';
        });
        if(target.isMinEquip()){
            target.equip(event.equip||game.createCard(get.inpilefull('equip').randomGet()),true);
            event.e=true;
        }
        'step 1'
        if(!event.h&&player.isMinHandcard()){
            player.draw();
        }
        if(!event.hp&&player.isMinHp()&&player.isDamaged()){
            player.recover();
        }
        if(!event.e&&player.isMinEquip()){
            player.equip(event.equip||game.createCard(get.inpilefull('equip').randomGet()),true);
        }
    },
                ai:{
                    threaten:1.6,
                    order:9,
                    result:{
                        player:function (player,target){
                if(get.attitude(player,target)<=0){
                    if(target.isMinHandcard()||target.isMinEquip()||target.isMinHp()) return -1;
                }
                var num=0;
                if(player.isMinHandcard()||target.isMinHandcard()) num++;
                if(player.isMinEquip()||target.isMinEquip()) num++;
                if((player.isMinHp()&&player.isDamaged())||(target.isMinHp()&&target.isDamaged())) num+=2.1;
                return num;
            },
                    },
                },
            },
            "奋迅":{
                enable:"phaseUse",
                usable:1,
                position:"he",
                filterTarget:function (card,player,target){
        return target!=player;
    },
                content:function (){
        player.storage.fenxun2=target;
        player.addTempSkill('fenxun2');
    },
                check:function (card){
        if(card.name=='sha'&&_status.event.player.countCards('h','sha')<=1) return 0;
        return 6-get.value(card);
    },
                filterCard:true,
                ai:{
                    order:4,
                    result:{
                        player:function (player,target){
                if(get.distance(player,target)<=1) return 0;
                var hs=player.getCards('h','shunshou');
                if(hs.length&&player.canUse(hs[0],target,false)){
                    return 1;
                }
                var geteff=function(current){
                    return player.canUse('sha',current,false,true)&&get.effect(current,{name:'sha'},player,player)>0;
                }
                if(player.hasSha()&&geteff(target)){
                    var num=game.countPlayer(function(current){
                        return current!=player&&get.distance(player,current)<=1&&geteff(current);
                    });
                    if(num==0){
                        if(game.hasPlayer(function(current){
                            return player.canUse('sha',current)&&geteff(current)&&current!=target;
                        })){
                            return 1;
                        }
                    }
                    else if(num==1){
                        return 1;
                    }
                }
                return 0;
            },
                    },
                },
            },
            "短兵":{
                trigger:{
                    player:"useCard",
                },
                filter:function (event,player){
        if(event.card.name!='sha') return false;
        return game.hasPlayer(function(current){
            return !event.targets.contains(current)&&get.distance(player,current)<=1&&player.canUse('sha',current);
        });
    },
                direct:true,
                content:function (){
        'step 0'
        player.chooseTarget(get.prompt('duanbing'),function(card,player,target){
            return !_status.event.source.contains(target)&&get.distance(player,target)<=1&&player.canUse('sha',target);
        }).set('source',trigger.targets).set('ai',function(target){
            var player=_status.event.player;
            return get.effect(target,{name:'sha'},player,player);
        });
        'step 1'
        if(result.bool){
            if(!event.isMine()&&!_status.connectMode) game.delayx();
            event.target=result.targets[0];
        }
        else{
            event.finish();
        }
        'step 2'
        player.logSkill('duanbing',event.target);
        trigger.targets.push(event.target);
    },
                ai:{
                    effect:{
                        player:function (card,player,target){
                if(card.name=='sha'){
                    if(player._duanbingtmp) return;
                    player._duanbingtmp=true;
                    if(get.effect(target,{name:'sha'},player,player)<=0){
                        delete player._duanbingtmp;
                        return;
                    }
                    if(game.hasPlayer(function(current){
                        return current!=target&&get.distance(player,current)<=1&&
                        player.canUse('sha',current)&&get.effect(current,{name:'sha'},player,player)>0;
                    })){
                        delete player._duanbingtmp;
                        return [1,1];
                    }
                    delete player._duanbingtmp;
                }
            },
                    },
                },
            },
            "狂骨":{
                trigger:{
                    source:"damageEnd",
                },
                filter:function (event,player){
        return get.distance(player,event.player)<=1&&event.num>0;
    },
                direct:true,
                audio:"kuanggu",
                content:function (){
        'step 0'
        event.num=trigger.num;
        'step 1'
        player.chooseDrawRecover(get.prompt('xinkuanggu')).set('logSkill','xinkuanggu');
        'step 2'
        if(result.control!='cancel2'){
            event.num--;
            if(event.num>0){
                event.goto(1);
            }
        }
    },
            },
            "武圣":{
                audio:"ext:异界四国:3",
                enable:["chooseToRespond","chooseToUse"],
                filterCard:function (card,player){
        if(get.zhu(player,'shouyue')) return true;
        return get.color(card)=='red';
    },
                position:"he",
                viewAs:{
                    name:"sha",
                },
                viewAsFilter:function (player){
        if(get.zhu(player,'shouyue')){
            if(!player.countCards('he')) return false;
        }
        else{
            if(!player.countCards('he',{color:'red'})) return false;
        }
    },
                prompt:"将一张红色牌当杀使用或打出",
                check:function (card){return 4-get.value(card)},
                ai:{
                    skillTagFilter:function (player){
            if(get.zhu(player,'shouyue')){
                if(!player.countCards('he')) return false;
            }
            else{
                if(!player.countCards('he',{color:'red'})) return false;
            }
        },
                    respondSha:true,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    order:function (){
                        if(_status.event.player.hasSkillTag('presha',true,null,true)) return 10;
                        return 3;
                    },
                    result:{
                        target:function (player,target){
                            if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                                if(get.attitude(player,target)>0){
                                    return -6;
                                }
                                else{
                                    return -3;
                                }
                            }
                            return -1.5;
                        },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                            if(card.nature=='poison') return;
                            return 1;
                        },
                        natureDamage:function (card){
                            if(card.nature) return 1;
                        },
                        fireDamage:function (card,nature){
                            if(card.nature=='fire') return 1;
                        },
                        thunderDamage:function (card,nature){
                            if(card.nature=='thunder') return 1;
                        },
                        poisonDamage:function (card,nature){
                            if(card.nature=='poison') return 1;
                        },
                    },
                },
            },
            "奇谋":{
                unique:true,
                enable:"phaseUse",
                filter:function (event,player){
        return !player.storage.qimou;
    },
                init:function (player){
        player.storage.qimou=false;
    },
                mark:true,
                intro:{
                    content:"limited",
                },
                skillAnimation:"legend",
                animationColor:"metal",
                content:function (){
        'step 0'
        var shas=player.getCards('h','sha');
        var num;
        if(player.hp>=4&&shas.length>=3){
            num=3;
        }
        else if(player.hp>=3&&shas.length>=2){
            num=2;
        }
        else{
            num=1
        }
        player.awakenSkill('qimou');
        player.storage.qimou=true;
        player.chooseControl('一','二','三','四','五','六',function(){
            return get.cnNumber(_status.event.goon,true);
        }).set('prompt','失去任意点体力').set('goon',num);
        'step 1'
        var num;
        switch(result.control){
            case '一':num=1;break;
            case '二':num=2;break;
            case '三':num=3;break;
            case '四':num=4;break;
            case '五':num=5;break;
            case '六':num=6;break;
        }
        player.storage.qimou2=num;
        player.loseHp(num);
        player.addTempSkill('qimou2');
    },
                ai:{
                    order:2,
                    result:{
                        player:function (player){
                if(player.hp==1) return 0;
                var shas=player.getCards('h','sha');
                if(!shas.length) return 0;
                var card=shas[0];
                if(!lib.filter.cardEnabled(card,player)) return 0;
                if(lib.filter.cardUsable(card,player)) return 0;
                var mindist;
                if(player.hp>=4&&shas.length>=3){
                    mindist=4;
                }
                else if(player.hp>=3&&shas.length>=2){
                    mindist=3;
                }
                else{
                    mindist=2;
                }
                if(game.hasPlayer(function(current){
                    return (current.hp<=mindist-1&&
                        get.distance(player,current,'attack')<=mindist&&
                        player.canUse(card,current,false)&&
                        get.effect(current,card,player,player)>0);
                })){
                    return 1;
                }
                return 0;
            },
                    },
                },
            },
            "陷阵":{
                audio:"ext:异界四国:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.countCards('h')>0;
    },
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(target);
        "step 1"
        if(result.bool){
            player.storage.xianzhen=target;
            player.addTempSkill('xianzhen2');
        }
        else{
            player.addTempSkill('xianzhen3');
        }
    },
                ai:{
                    order:function (name,player){
            var cards=player.getCards('h');
            if(player.countCards('h','sha')==0){
                return 1;
            }
            for(var i=0;i<cards.length;i++){
                if(cards[i].name!='sha'&&cards[i].number>11&&get.value(cards[i])<7){
                    return 9;
                }
            }
            return get.order({name:'sha'})-1;
        },
                    result:{
                        player:function (player){
                if(player.countCards('h','sha')>0) return 0;
                var num=player.countCards('h');
                if(num>player.hp) return 0;
                if(num==1) return -2;
                if(num==2) return -1;
                return -0.7;
            },
                        target:function (player,target){
                var num=target.countCards('h');
                if(num==1) return -1;
                if(num==2) return -0.7;
                return -0.5
            },
                    },
                    threaten:1.3,
                },
            },
            "禁酒":{
                mod:{
                    cardEnabled:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='jinjiu') return false;
        },
                    cardUsable:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='jinjiu') return false;
        },
                    cardRespondable:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='jinjiu') return false;
        },
                    cardSavable:function (card,player){
            if(card.name=='jiu'&&_status.event.skill!='jinjiu') return false;
        },
                },
                enable:["chooseToUse","chooseToRespond"],
                filter:function (event,player){
        return player.countCards('h','jiu')>0;
    },
                filterCard:{
                    name:"jiu",
                },
                viewAs:{
                    name:"sha",
                },
                viewAsFilter:function (player){
        if(!player.countCards('h','jiu')) return false;
    },
                check:function (){return 1},
                ai:{
                    skillTagFilter:function (player){
            if(!player.countCards('h','jiu')) return false;
        },
                    respondSha:true,
                    order:4,
                    useful:-1,
                    value:-1,
                    basic:{
                        useful:[5,1],
                        value:[5,1],
                    },
                    result:{
                        target:function (player,target){
                            if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                                if(get.attitude(player,target)>0){
                                    return -6;
                                }
                                else{
                                    return -3;
                                }
                            }
                            return -1.5;
                        },
                    },
                    tag:{
                        respond:1,
                        respondShan:1,
                        damage:function (card){
                            if(card.nature=='poison') return;
                            return 1;
                        },
                        natureDamage:function (card){
                            if(card.nature) return 1;
                        },
                        fireDamage:function (card,nature){
                            if(card.nature=='fire') return 1;
                        },
                        thunderDamage:function (card,nature){
                            if(card.nature=='thunder') return 1;
                        },
                        poisonDamage:function (card,nature){
                            if(card.nature=='poison') return 1;
                        },
                    },
                },
            },
            "天辩":{
                trigger:{
                    player:"chooseCardBegin",
                },
                check:function (event,player){
        return player.hasCard(function(card){
            var val=get.value(card);
            return val<0||(val<=4&&card.number>=11);
        });
    },
                filter:function (event){
        return event.type=='compare'&&!event.directresult;
    },
                content:function (){
        var cards=get.cards();
        cards[0].discard();
        cards[0].vanishtag.add('tianbian');
        trigger.directresult=cards;
        trigger.untrigger();
    },
                group:"tianbian_number",
                subSkill:{
                    number:{
                        trigger:{
                            player:"compare",
                            target:"compare",
                        },
                        filter:function (event,player){
                if(event.iwhile) return false;
                if(event.player==player){
                    return get.suit(event.card1)=='heart';//&&event.card1.vanishtag.contains('tianbian');
                }
                else{
                    return get.suit(event.card2)=='heart';//&&event.card2.vanishtag.contains('tianbian');
                }
            },
                        silent:true,
                        content:function (){
                game.log(player,'拼点牌点数视为','#y13');
                if(player==trigger.player){
                    trigger.num1=13;
                }
                else{
                    trigger.num2=13;
                }
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                },
            },
            "遗计":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"damageEnd",
                },
                frequent:true,
                filter:function (event){
        return (event.num>0)
    },
                content:function (){
        "step 0"
        event.cards=get.cards(2*trigger.num);
        "step 1"
        if(event.cards.length>1){
            player.chooseCardButton('将“遗计”牌分配给任意角色',true,event.cards,[1,event.cards.length]).set('ai',function(button){
                if(ui.selected.buttons.length==0) return 1;
                return 0;
            });
        }
        else if(event.cards.length==1){
            event._result={links:event.cards.slice(0),bool:true};
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            for(var i=0;i<result.links.length;i++){
                event.cards.remove(result.links[i]);
            }
            event.togive=result.links.slice(0);
            player.chooseTarget('将'+get.translation(result.links)+'交给一名角色',true).set('ai',function(target){
                var att=get.attitude(_status.event.player,target);
                if(_status.event.enemy){
                    return -att;
                }
                else if(att>0){
                    return att/(1+target.countCards('h'));
                }
                else{
                    return att/100;
                }
            }).set('enemy',get.value(event.togive[0])<0);
        }
        "step 3"
        if(result.targets.length){
            result.targets[0].gain(event.togive,'draw');
            player.line(result.targets[0],'green');
            game.log(result.targets[0],'获得了'+get.cnNumber(event.togive.length)+'张牌');
            event.goto(1);
        }
    },
                ai:{
                    maixie:true,
                    "maixie_hp":true,
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(player.hasSkillTag('jueqing',false,target)) return [1,-2];
                    if(!target.hasFriend()) return;
                    var num=1;
                    if(get.attitude(player,target)>0){
                        if(player.needsToDiscard()){
                            num=0.7;
                        }
                        else{
                            num=0.5;
                        }
                    }
                    if(target.hp>=4) return [1,num*2];
                    if(target.hp==3) return [1,num*1.5];
                    if(target.hp==2) return [1,num*0.5];
                }
            },
                    },
                },
            },
            "龙胆":{
                group:["longdan_sha","longdan_shan","longdan_draw"],
                subSkill:{
                    draw:{
                        trigger:{
                            player:["useCard","respond"],
                        },
                        forced:true,
                        popup:false,
                        filter:function (event,player){
                if(!get.zhu(player,'shouyue')) return false;
                return event.skill=='longdan_sha'||event.skill=='longdan_shan';
            },
                        content:function (){
                player.draw();
                player.storage.fanghun2++;
            },
                        sub:true,
                    },
                    sha:{
                        audio:2,
                        enable:["chooseToUse","chooseToRespond"],
                        filterCard:{
                            name:"shan",
                        },
                        viewAs:{
                            name:"sha",
                        },
                        viewAsFilter:function (player){
                if(!player.countCards('h','shan')) return false;
            },
                        prompt:"将一张闪当杀使用或打出",
                        check:function (){return 1},
                        ai:{
                            effect:{
                                target:function (card,player,target,current){
                        if(get.tag(card,'respondSha')&&current<0) return 0.6
                    },
                            },
                            respondSha:true,
                            skillTagFilter:function (player){
                    if(!player.countCards('h','shan')) return false;
                },
                            order:function (){
                    return get.order({name:'sha'})+0.1;
                },
                            useful:-1,
                            value:-1,
                            basic:{
                                useful:[5,1],
                                value:[5,1],
                            },
                            result:{
                                target:function (player,target){
                            if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                                if(get.attitude(player,target)>0){
                                    return -6;
                                }
                                else{
                                    return -3;
                                }
                            }
                            return -1.5;
                        },
                            },
                            tag:{
                                respond:1,
                                respondShan:1,
                                damage:function (card){
                            if(card.nature=='poison') return;
                            return 1;
                        },
                                natureDamage:function (card){
                            if(card.nature) return 1;
                        },
                                fireDamage:function (card,nature){
                            if(card.nature=='fire') return 1;
                        },
                                thunderDamage:function (card,nature){
                            if(card.nature=='thunder') return 1;
                        },
                                poisonDamage:function (card,nature){
                            if(card.nature=='poison') return 1;
                        },
                            },
                        },
                        sub:true,
                    },
                    shan:{
                        audio:2,
                        enable:["chooseToRespond"],
                        filterCard:{
                            name:"sha",
                        },
                        viewAs:{
                            name:"shan",
                        },
                        prompt:"将一张杀当闪打出",
                        check:function (){return 1},
                        viewAsFilter:function (player){
                if(!player.countCards('h','sha')) return false;
            },
                        ai:{
                            respondShan:true,
                            skillTagFilter:function (player){
                    if(!player.countCards('h','sha')) return false;
                },
                            effect:{
                                target:function (card,player,target,current){
                        if(get.tag(card,'respondShan')&&current<0) return 0.6
                    },
                            },
                            order:4,
                            useful:-1,
                            value:-1,
                            basic:{
                                useful:[7,2],
                                value:[7,2],
                            },
                        },
                        sub:true,
                    },
                },
            },
            "冲阵":{
                group:["chongzhen1","chongzhen2"],
                ai:{
                    combo:"longdan",
                    mingzhi:false,
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'respondShan')||get.tag(card,'respondSha')){
                    if(get.attitude(target,player)<=0){
                        if(current>0) return;
                        if(target.countCards('h')==0) return 1.6;
                        if(target.countCards('h')==1) return 1.2;
                        if(target.countCards('h')==2) return [0.8,0.2,0,-0.2];
                        return [0.4,0.7,0,-0.7];
                    }
                }
            },
                    },
                },
            },
            "咆哮":{
                mod:{
                    cardUsable:function (card,player,num){
            if(card.name=='sha') return Infinity;
        },
                },
                ai:{
                    unequip:true,
                    skillTagFilter:function (player,tag,arg){
            if(!get.zhu(player,'shouyue')) return false;
            if(arg&&arg.name=='sha') return true;
            return false;
        },
                },
            },
            "离魂":{
                audio:"ext:异界四国:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.sex=='male';
    },
                filterCard:true,
                position:"he",
                content:function (){
        player.gain(target.getCards('h'),target);
        target.$give(target.countCards('h'),player);
        player.turnOver();
        player.addSkill('lihun2');
        player.storage.lihun=target;
    },
                check:function (card){return 8-get.value(card)},
                ai:{
                    order:10,
                    result:{
                        player:function (player){
                if(player.classList.contains('turnedover')) return 10;
                return 0;
            },
                        target:function (player,target){
                if(target.countCards('h')>target.hp) return target.hp-target.countCards('h');
                return 0;
            },
                    },
                    threaten:1.5,
                    effect:{
                        target:function (card){
                if(card.name=='guiyoujie') return [0,2];
            },
                    },
                },
            },
            "据守":{
                audio:"jushou",
                trigger:{
                    player:"phaseEnd",
                },
                content:function (){
        'step 0'
        player.draw(4);
        player.turnOver();
        'step 1'
        player.chooseCard('h',true,'弃置一张手牌，若以此法弃置的是装备牌，则你改为使用之').set('ai',function(card){
            if(get.type(card)=='equip'){
                return 5-get.value(card);
            }
            return -get.value(card);
        }).set('filterCard',lib.filter.cardDiscardable);
        'step 2'
        if(result.bool&&result.cards.length){
            if(get.type(result.cards[0])=='equip'){
                player.$give(result.cards,player);
                player.lose(result.cards,ui.special);
                event.toequip=result.cards[0];
            }
            else{
                player.discard(result.cards[0]);
            }
        }
        'step 3'
        if(event.toequip){
            game.delay();
        }
        'step 4'
        if(event.toequip){
            player.equip(event.toequip);
        }
    },
                ai:{
                    effect:{
                        target:function (card,player,target){
                if(card.name=='guiyoujie') return [0,1];
            },
                    },
                },
            },
            "空城":{
                mod:{
                    targetEnabled:function (card,player,target,now){
            if(target.countCards('h')==0){
                if(card.name=='sha'||card.name=='juedou') return false;
            }
        },
                },
                group:"kongcheng1",
                ai:{
                    noh:true,
                    skillTagFilter:function (player,tag){
            if(tag=='noh'){
                if(player.countCards('h')!=1) return false;
            }
        },
                },
            },
            "极奢":{
                enable:"phaseUse",
                filter:function (event,player){
        return player.getHandcardLimit()>0;
    },
                init:function (player){
        player.storage.jishe=0;
    },
                usable:20,
                content:function (){
        player.draw();
        player.storage.jishe++;
    },
                ai:{
                    order:10,
                    result:{
                        player:function (player){
                if(!player.needsToDiscard(1)){
                    return 1;
                }
                return 0;
            },
                    },
                },
                mod:{
                    maxHandcard:function (player,num){
            return num-player.storage.jishe;
        },
                },
                group:["jishe2","jishe3"],
            },
            "裸衣":{
                audio:"reluoyi",
                trigger:{
                    player:"phaseDrawBegin",
                },
                content:function (){
        "step 0"
        player.addTempSkill('ol_reluoyi_1',{player:'phaseBefore'});
        trigger.untrigger();
        trigger.finish();
        "step 1"
        event.cards=get.cards(3);
        player.showCards(event.cards,'裸衣');
        "step 2"
        for(var i=0;i<cards.length;i++){
            if(get.type(cards[i])!='basic'&&cards[i].name!='juedou'&&
                (get.type(cards[i])!='equip'||get.subtype(cards[i])!='equip1')){
                ui.discardPile.appendChild(cards[i]);
                cards.splice(i--,1);
            }
        }
        player.gain(cards,'gain2');
    },
                subSkill:{
                    "1":{
                        audio:false,
                        trigger:{
                            source:"damageBegin",
                        },
                        mark:true,
                        intro:{
                            content:"直到你的下回合开始，你为伤害来源的【杀】或【决斗】造成的伤害+1。",
                        },
                        filter:function (event){
                return event.card&&(event.card.name=='sha'||event.card.name=='juedou')&&event.notLink();
            },
                        forced:true,
                        content:function (){
                trigger.num++;
            },
                        sub:true,
                    },
                },
            },
            "闭月":{
                audio:"biyue",
                trigger:{
                    player:"phaseEnd",
                },
                frequent:true,
                alter:true,
                content:function (){
        var num=1;
        if(get.is.altered('xinbiyue')&&!player.countCards('h')){
            num=2;
        }
        player.draw(num);
    },
            },
            "庸肆":{
                group:["xinyongsi1","xinyongsi2"],
            },
            "伤势":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:["loseEnd","changeHp"],
                },
                forced:true,
                filter:function (event,player){
        return (player.countCards('h')<Math.min(3,player.maxHp-player.hp));
    },
                content:function (){
        player.draw(Math.min(3,player.maxHp-player.hp)-player.countCards('h'));
    },
                ai:{
                    noh:true,
                    skillTagFilter:function (player,tag){
            if(tag=='noh'&&player.maxHp-player.hp<player.countCards('h')){
                return false;
            }
        },
                },
            },
            "再起":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"phaseDrawBefore",
                },
                filter:function (event,player){
        return player.hp<player.maxHp;
    },
                check:function (event,player){
        if(player.maxHp-player.hp<2){
            return false;
        }
        else if(player.maxHp-player.hp==2){
            return player.countCards('h')>=2;
        }
        return true;
    },
                content:function (){
        "step 0"
        trigger.cancel();
        event.cards=get.cards(player.maxHp-player.hp);
        player.showCards(event.cards);
        "step 1"
        var num=0;
        for(var i=0;i<event.cards.length;i++){
            if(get.suit(event.cards[i])=='heart'){
                num++;
                event.cards[i].discard();
                event.cards.splice(i--,1);
            }
        }
        if(num){
            player.recover(num);
        }
        "step 2"
        if(event.cards.length){
            player.gain(event.cards);
            player.$gain2(event.cards);
            game.delay();
        }
    },
                ai:{
                    threaten:function (player,target){
            if(target.hp==1) return 2;
            if(target.hp==2) return 1.5;
            return 1;
        },
                },
            },
            "崩坏":{
                audio:"ext:异界四国:4",
                trigger:{
                    player:"phaseEnd",
                },
                forced:true,
                check:function (){
        return false;
    },
                filter:function (event,player){
        return !player.isMinHp();
    },
                content:function (){
        "step 0"
        player.chooseControl('baonue_hp','baonue_maxHp',function(event,player){
            if(player.hp==player.maxHp) return 'baonue_hp';
            if(player.hp<player.maxHp-1||player.hp<=2) return 'baonue_maxHp';
            return 'baonue_hp';
        });
        "step 1"
        if(result.control=='baonue_hp'){
            player.loseHp();
        }
        else{
            player.loseMaxHp(true);
        }
    },
                ai:{
                    threaten:0.5,
                    neg:true,
                },
            },
            "肉林":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"shaBegin",
                    target:"shaBegin",
                },
                forced:true,
                filter:function (event,player){
        if(event.directHit) return false;
        if(player==event.player){
            return event.target.sex=='female';
        }
        return event.player.sex=='female';
    },
                check:function (event,player){
        return player==event.player;
    },
                priority:-1,
                content:function (){
        if(typeof trigger.shanRequired=='number'){
            trigger.shanRequired++;
        }
        else{
            trigger.shanRequired=2;
        }
    },
            },
            "奇策":{
                enable:"phaseUse",
                usable:1,
                audio:"ext:异界四国:2",
                filter:function (event,player){
        return player.countCards('h')>0
    },
                chooseButton:{
                    dialog:function (){
            var list=['taoyuan','wugu','juedou','huogong','jiedao','tiesuo','guohe','shunshou','wuzhong','wanjian','nanman'];
            for(var i=0;i<list.length;i++){
                list[i]=['锦囊','',list[i]];
            }
            return ui.create.dialog(get.translation('qice'),[list,'vcard']);
        },
                    filter:function (button,player){
            return lib.filter.filterCard({name:button.link[2]},player,_status.event.getParent());
        },
                    check:function (button){
            var player=_status.event.player;
            var recover=0,lose=1,players=game.filterPlayer();
            for(var i=0;i<players.length;i++){
                if(players[i].hp==1&&get.damageEffect(players[i],player,player)>0&&!players[i].hasSha()){
                    return (button.link[2]=='juedou')?2:-1;
                }
                if(!players[i].isOut()){
                    if(players[i].hp<players[i].maxHp){
                        if(get.attitude(player,players[i])>0){
                            if(players[i].hp<2){
                                lose--;
                                recover+=0.5;
                            }
                            lose--;
                            recover++;
                        }
                        else if(get.attitude(player,players[i])<0){
                            if(players[i].hp<2){
                                lose++;
                                recover-=0.5;
                            }
                            lose++;
                            recover--;
                        }
                    }
                    else{
                        if(get.attitude(player,players[i])>0){
                            lose--;
                        }
                        else if(get.attitude(player,players[i])<0){
                            lose++;
                        }
                    }
                }
            }
            if(lose>recover&&lose>0) return (button.link[2]=='nanman')?1:-1;
            if(lose<recover&&recover>0) return (button.link[2]=='taoyuan')?1:-1;
            return (button.link[2]=='wuzhong')?1:-1;
        },
                    backup:function (links,player){
            return {
                filterCard:true,
                selectCard:-1,
                audio:2,
                popname:true,
                viewAs:{name:links[0][2]},
            }
        },
                    prompt:function (links,player){
            return '将全部手牌当作'+get.translation(links[0][2])+'使用';
        },
                },
                ai:{
                    order:1,
                    result:{
                        player:function (player){
                var num=0;
                var cards=player.getCards('h');
                if(cards.length>=3&&player.hp>=3) return 0;
                for(var i=0;i<cards.length;i++){
                    num+=Math.max(0,get.value(cards[i],player,'raw'));
                }
                num/=cards.length;
                num*=Math.min(cards.length,player.hp);
                return 12-num;
            },
                    },
                    threaten:1.6,
                },
            },
            "恢拓":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"damageEnd",
                },
                direct:true,
                content:function (){
        'step 0'
        player.chooseTarget(get.prompt('huituo')).set('ai',function(target){
            var player=_status.event.player;
            if(get.attitude(player,target)>0){
                return get.recoverEffect(target,player,player)+1;
            }
            return 0;
        });
        'step 1'
        if(result.bool){
            player.logSkill('huituo',result.targets);
            var target=result.targets[0];
            event.target=target;
            target.judge(function(card){
                if(target.hp==target.maxHp){
                    if(get.color(card)=='red') return -1;
                }
                if(get.color(card)=='red') return 1;
                return 0;
            });
        }
        else{
            event.finish();
        }
        'step 2'
        if(result.color){
            if(result.color=='red'){
                if(event.target.hp<event.target.maxHp) event.target.recover();
            }
            else{
                event.target.draw(trigger.num);
            }
        }
    },
                ai:{
                    maixie:true,
                    "maixie_hp":true,
                },
            },
            "巨象":{
                unique:true,
                locked:true,
                group:["juxiang1","juxiang2"],
                ai:{
                    effect:{
                        target:function (card){
                if(card.name=='nanman') return [0,1];
            },
                    },
                },
            },
            "烈刃":{
                audio:"ext:异界四国:2",
                trigger:{
                    source:"damageEnd",
                },
                filter:function (event,player){
        if(event._notrigger.contains(event.player)) return false;
        return (event.card&&event.card.name=='sha'&&
            event.player.classList.contains('dead')==false&&
            event.player.countCards('h')&&player.countCards('h'))&&event.player!=player;
    },
                check:function (event,player){
        return get.attitude(player,event.player)<0&&player.countCards('h')>1;
    },
                priority:5,
                content:function (){
        "step 0"
        player.chooseToCompare(trigger.player);
        "step 1"
        if(result.bool&&trigger.player.countGainableCards(player,'he')){
            player.gainPlayerCard(trigger.player,true,'he');
        }
    },
            },
            "奇袭":{
                audio:"ext:异界四国:4",
                enable:"chooseToUse",
                filterCard:function (card){
        return get.color(card)=='black';
    },
                position:"he",
                viewAs:{
                    name:"guohe",
                },
                viewAsFilter:function (player){
        if(!player.countCards('he',{color:'black'})) return false;
    },
                prompt:"将一张黑色牌当过河拆桥使用",
                check:function (card){return 4-get.value(card)},
                ai:{
                    basic:{
                        order:9,
                        useful:1,
                        value:5,
                    },
                    result:{
                        target:function (player,target){
                            var att=get.attitude(player,target);
                            var nh=target.countCards('h');
                            if(att>0){
                                var js=target.getCards('j');
                                if(js.length){
                                    var jj=js[0].viewAs?{name:js[0].viewAs}:js[0];
                                    if(jj.name=='guohe'||js.length>1||get.effect(target,jj,target,player)<0){
                                        return 3;
                                    }
                                }
                                if(target.getEquip('baiyin')&&target.isDamaged()&&
                                    get.recoverEffect(target,player,player)>0){
                                    if(target.hp==1&&!target.hujia) return 1.6;
                                    if(target.hp==2) return 0.01;
                                    return 0;
                                }
                            }
                            var es=target.getCards('e');
                            var noe=(es.length==0||target.hasSkillTag('noe'));
                            var noe2=(es.length==1&&es[0].name=='baiyin'&&target.isDamaged());
                            var noh=(nh==0||target.hasSkillTag('noh'));
                            if(noh&&(noe||noe2)) return 0;
                            if(att<=0&&!target.countCards('he')) return 1.5;
                            return -1.5;
                        },
                    },
                    tag:{
                        loseCard:1,
                        discard:1,
                    },
                },
            },
            "洛神":{
                audio:"luoshen",
                alter:true,
                trigger:{
                    player:"phaseBegin",
                },
                frequent:true,
                content:function (){
        "step 0"
        if(event.cards==undefined) event.cards=[];
        player.judge(function(card){
            if(get.color(card)=='black') return 1.5;
            return -1.5;
        },ui.special);
        "step 1"
        if(result.judge>0){
            event.cards.push(result.card);
            if(lib.config.autoskilllist.contains('luoshen')){
                player.chooseBool('是否再次发动【洛神】？');
            }
            else{
                event._result={bool:true};
            }
        }
        else{
            for(var i=0;i<event.cards.length;i++){
                if(get.position(event.cards[i])!='s'){
                    event.cards.splice(i,1);i--;
                }
            }
            player.gain(event.cards,'gain2');
            player.storage.xinluoshen=event.cards.slice(0);
            event.finish();
        }
        "step 2"
        if(result.bool){
            event.goto(0);
        }
        else{
            if(event.cards.length){
                player.gain(event.cards,'gain2');
                player.storage.xinluoshen=event.cards.slice(0);
            }
        }
    },
                mod:{
                    ignoredHandcard:function (card,player){
            if(get.is.altered('xinluoshen')&&player.storage.xinluoshen&&player.storage.xinluoshen.contains(card)){
                return true;
            }
        },
                },
                group:"xinluoshen_clear",
                subSkill:{
                    clear:{
                        trigger:{
                            player:"phaseAfter",
                        },
                        silent:true,
                        content:function (){
                delete player.storage.xinluoshen;
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                },
            },
            "鬼才":{
                audio:"ext:异界四国:2",
                trigger:{
                    global:"judge",
                },
                direct:true,
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseCard(get.translation(trigger.player)+'的'+(trigger.judgestr||'')+'判定为'+
        get.translation(trigger.player.judging[0])+'，'+get.prompt('guicai')).set('ai',function(card){
            var trigger=_status.event.getTrigger();
            var player=_status.event.player;
            var judging=_status.event.judging;
            var result=trigger.judge(card)-trigger.judge(judging);
            var attitude=get.attitude(player,trigger.player);
            if(attitude==0||result==0) return 0;
            if(attitude>0){
                return result-get.value(card)/2;
            }
            else{
                return -result-get.value(card)/2;
            }
        }).set('judging',trigger.player.judging[0]);
        "step 1"
        if(result.bool){
            player.respond(result.cards,'highlight');
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            player.logSkill('guicai');
            if(trigger.player.judging[0].clone){
                trigger.player.judging[0].clone.classList.remove('thrownhighlight');
                game.broadcast(function(card){
                    if(card.clone){
                        card.clone.classList.remove('thrownhighlight');
                    }
                },trigger.player.judging[0]);
                game.addVideo('deletenode',player,get.cardsInfo([trigger.player.judging[0].clone]));
            }
            trigger.player.judging[0].discard();
            trigger.player.judging[0]=result.cards[0];
            if(!get.owner(result.cards[0],'judge')){
                trigger.position.appendChild(result.cards[0]);
            }
            game.log(trigger.player,'的判定牌改为',result.cards[0]);
            game.delay(2);
        }
    },
                ai:{
                    tag:{
                        rejudge:1,
                    },
                },
            },
            "矢北":{
                trigger:{
                    player:"damageEnd",
                },
                forced:true,
                audio:"ext:异界四国:2",
                content:function (){
        if(player.hasSkill('shibei_damaged')){
            player.loseHp();
        }
        else{
            player.recover();
        }
    },
                group:"shibei_mark",
                subSkill:{
                    mark:{
                        trigger:{
                            player:"damageAfter",
                        },
                        silent:true,
                        content:function (){
                player.addTempSkill('shibei_damaged');
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                    damaged:{
                        sub:true,
                    },
                    ai:{
                        sub:true,
                    },
                },
                ai:{
                    "maixie_defend":true,
                    threaten:0.9,
                    effect:{
                        target:function (card,player,target){
                if(player.hasSkillTag('jueqing')) return;
                if(target.hujia) return;
                if(player._shibei_tmp) return;
                if(target.hasSkill('shibei_ai')) return;
                if(_status.event.getParent('useCard',true)||_status.event.getParent('_wuxie',true)) return;
                if(get.tag(card,'damage')){
                    if(target.hasSkill('shibei_damaged')){
                        return [1,-2];
                    }
                    else{
                        if(get.attitude(player,target)>0&&target.hp>1){
                            return 0;
                        }
                        if(get.attitude(player,target)<0&&!player.hasSkillTag('damageBonus')){
                            if(card.name=='sha') return;
                            var sha=false;
                            player._shibei_tmp=true;
                            var num=player.countCards('h',function(card){
                                if(card.name=='sha'){
                                    if(sha){
                                        return false;
                                    }
                                    else{
                                        sha=true;
                                    }
                                }
                                return get.tag(card,'damage')&&player.canUse(card,target)&&get.effect(target,card,player,player)>0;
                            });
                            delete player._shibei_tmp;
                            if(player.hasSkillTag('damage')){
                                num++;
                            }
                            if(num<2){
                                var enemies=player.getEnemies();
                                if(enemies.length==1&&enemies[0]==target&&player.needsToDiscard()){
                                    return;
                                }
                                return 0;
                            }
                        }
                    }
                }
            },
                    },
                },
            },
            "清弦":{
                group:["qingxian_jilie","qingxian_rouhe"],
                ai:{
                    threaten:0.8,
                    maixie:true,
                    "maixie_hp":true,
                    "maixie_defend":true,
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(target.hp>1&&target.hasFriend()) return 0.8;
                }
            },
                    },
                },
                subSkill:{
                    rouhe:{
                        trigger:{
                            player:"recoverEnd",
                        },
                        direct:true,
                        content:function (){
                'step 0'
                player.chooseTarget(get.prompt('qingxian'),function(card,player,target){
                    return target!=player;
                }).set('ai',function(target){
                    var att=get.attitude(_status.event.player,target);
                    if(target.isHealthy()&&att>0) return 0;
                    if(target.hp==1&&att!=0){
                        if(att>0) return 9;
                        else return 10;
                    }
                    else{
                        return Math.sqrt(Math.abs(att));
                    }
                }).set('prompt2','当你回复体力后，你可以令一名其他角色执行一项：失去1点体力，随机使用一张装备牌；回复1点体力，弃置一张装备牌。若其以此法使用或弃置的牌为梅花，你回复1点体力');
                'step 1'
                if(result.bool){
                    var target=result.targets[0];
                    player.logSkill('qingxian',target);
                    event.insert(lib.skill.qingxian.content_choose,{target:target,player:player});

                }
            },
                        sub:true,
                    },
                    jilie:{
                        trigger:{
                            player:"damageEnd",
                        },
                        filter:function (event,player){
                return event.source&&event.source.isIn()&&event.source!=player;
            },
                        check:function (event,player){
                if(get.attitude(player,event.source)>0&&event.source.isHealthy()){
                    return false;
                }
                return true;
            },
                        logTarget:"source",
                        "prompt2":"当你受到伤害后，你可以令伤害来源执行一项：失去1点体力，随机使用一张装备牌；回复1点体力，弃置一张装备牌。若其以此法使用或弃置的牌为梅花，你回复1点体力",
                        content:function (){
                event.insert(lib.skill.qingxian.content_choose,{target:trigger.source,player:player});
            },
                        sub:true,
                    },
                },
                "content_choose":function (){
        'step 0'
        var index;
        if(get.attitude(player,target)>0){
            if(target.isHealthy()){
                index=0;
            }
            else{
                index=1;
            }
        }
        else{
            if(target.isHealthy()&&target.countCards('e')){
                index=1;
            }
            else{
                index=0;
            }
        }
        player.chooseControlList(
            ['令'+get.translation(target)+'失去1点体力，随机使用一张装备牌',
            '令'+get.translation(target)+'回复1点体力，弃置一张装备牌'],
            true,function(event,player){
            return _status.event.index;
        }).set('index',index);
        'step 1'
        if(result.index==0){
            target.loseHp();
            event.card=get.cardPile(function(card){
                return get.type(card)=='equip';
            });
            if(event.card){
                target.equip(event.card,true).set('delay',true);
                event.goto(3);
            }
            else{
                event.finish();
            }
        }
        else{
            target.recover();
            if(target.countCards('he',{type:'equip'})){
                target.chooseToDiscard('he',true,'弃置一张装备牌',function(card){
                    return get.type(card)=='equip';
                }).set('ai',function(card){
                    var val=-get.value(card);
                    if(get.suit(card)=='club'){
                        val+=_status.event.att*10;
                    }
                    return val;
                }).set('att',get.sgnAttitude(target,player));
            }
            else{
                event.finish();
            }
        }
        'step 2'
        if(result&&result.cards){
            event.card=result.cards[0];
        }
        'step 3'
        if(event.card&&get.suit(event.card)=='club'){
            player.recover();
        }
    },
            },
            "酒诗":{
                group:["jiushi1","jiushi2","jiushi3"],
            },
            "解围":{
                audio:"yanzheng",
                enable:"chooseToUse",
                filterCard:true,
                position:"e",
                viewAs:{
                    name:"wuxie",
                },
                filter:function (event,player){
        return player.countCards('e')>0;
    },
                viewAsFilter:function (player){
        return player.countCards('e')>0;
    },
                prompt:"将一张装备区内的牌当无懈可击使用",
                check:function (card){return 8-get.equipValue(card)},
                threaten:1.2,
                group:"xinjiewei_move",
                subSkill:{
                    move:{
                        trigger:{
                            player:"turnOverEnd",
                        },
                        direct:true,
                        audio:"jiewei",
                        filter:function (event,player){
                return !player.isTurnedOver()&&player.canMoveCard();
            },
                        content:function (){
                "step 0"
                player.chooseToDiscard('he',get.prompt('xinjiewei'),'弃置一张牌并移动场上的一张牌',lib.filter.cardDiscardable).set('ai',function(card){
                    if(!_status.event.check) return 0;
                    return 7-get.value(card);
                }).set('check',player.canMoveCard(true)).set('logSkill','xinjiewei');
                "step 1"
                if(result.bool){
                    player.moveCard(true);
                }
                else{
                    event.finish();
                }
            },
                        sub:true,
                    },
                },
                ai:{
                    basic:{
                        useful:[6,4],
                        value:[6,4],
                    },
                    result:{
                        player:1,
                    },
                    expose:0.2,
                },
            },
            "奸雄":{
                audio:"jianxiong",
                alter:true,
                trigger:{
                    player:"damageEnd",
                },
                filter:function (event,player){
        return get.itemtype(event.cards)=='cards'&&get.position(event.cards[0])=='d';
    },
                content:function (){
        player.gain(trigger.cards);
        player.$gain2(trigger.cards);
        if(get.is.altered('xinjianxiong')){
            player.draw();
        }
    },
                ai:{
                    maixie:true,
                    "maixie_hp":true,
                    effect:{
                        target:function (card,player,target){
                if(player.hasSkillTag('jueqing',false,target)) return [1,-1];
                if(get.tag(card,'damage')) return [1,0.55];
            },
                    },
                },
            },
            "刚烈":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"damageEnd",
                },
                filter:function (event,player){
        return (event.source!=undefined);
    },
                check:function (event,player){
        return (get.attitude(player,event.source)<=0);
    },
                logTarget:"source",
                content:function (){
        "step 0"
        player.judge(function(card){
            if(get.suit(card)=='heart') return -2;
            return 2;
        })
        "step 1"
        if(result.judge<2){
            event.finish();return;
        }
        trigger.source.chooseToDiscard(2).set('ai',function(card){
            if(card.name=='tao') return -10;
            if(card.name=='jiu'&&_status.event.player.hp==1) return -10;
            return get.unuseful(card)+2.5*(5-get.owner(card).hp);
        });
        "step 2"
        if(result.bool==false){
            trigger.source.damage();
        }
    },
                ai:{
                    "maixie_defend":true,
                    effect:{
                        target:function (card,player,target){
                if(player.hasSkillTag('jueqing',false,target)) return [1,-1];
                return 0.8;
                // if(get.tag(card,'damage')&&get.damageEffect(target,player,player)>0) return [1,0,0,-1.5];
            },
                    },
                },
            },
            "雷击":{
                audio:"ext:异界四国:2",
                audioname:["boss_qinglong"],
                trigger:{
                    player:"respond",
                },
                filter:function (event,player){
        return event.card.name=='shan';
    },
                direct:true,
                content:function (){
        "step 0";
        player.chooseTarget(get.prompt('releiji')).ai=function(target){
            if(target.hasSkill('hongyan')) return 0;
            return get.damageEffect(target,_status.event.player,_status.event.player,'thunder');
        };
        "step 1"
        if(result.bool){
            player.logSkill('releiji',result.targets,'thunder');
            event.target=result.targets[0];
            event.target.judge(function(card){
                var suit=get.suit(card);
                if(suit=='spade') return -4;
                if(suit=='club') return -2;
                return 0;
            });
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.suit=='club'){
            event.target.damage('thunder');
            player.recover();
        }
        else if(result.suit=='spade'){
            event.target.damage(2,'thunder');
        }
    },
                ai:{
                    useShan:true,
                    effect:{
                        target:function (card,player,target,current){
                if(get.tag(card,'respondShan')){
                    var hastarget=game.hasPlayer(function(current){
                        return get.attitude(target,current)<0;
                    });
                    var be=target.countCards('e',{color:'black'});
                    if(target.countCards('h','shan')&&be){
                        if(!target.hasSkill('guidao')) return 0;
                        return [0,hastarget?target.countCards('he')/2:0];
                    }
                    if(target.countCards('h','shan')&&target.countCards('h')>2){
                        if(!target.hasSkill('guidao')) return 0;
                        return [0,hastarget?target.countCards('h')/4:0];
                    }
                    if(target.countCards('h')>3||(be&&target.countCards('h')>=2)){
                        return [0,0];
                    }
                    if(target.countCards('h')==0){
                        return [1.5,0];
                    }
                    if(target.countCards('h')==1&&!be){
                        return [1.2,0];
                    }
                    if(!target.hasSkill('guidao')) return [1,0.05];
                    return [1,Math.min(0.5,(target.countCards('h')+be)/4)];
                }
            },
                    },
                },
            },
            "鬼道":{
                audio:"ext:异界四国:2",
                trigger:{
                    global:"judge",
                },
                filter:function (event,player){
        return player.countCards('he',{color:'black'})>0;
    },
                direct:true,
                content:function (){
        "step 0"
        player.chooseCard(get.translation(trigger.player)+'的'+(trigger.judgestr||'')+'判定为'+
        get.translation(trigger.player.judging[0])+'，'+get.prompt('guidao'),'he',function(card){
            return get.color(card)=='black';
        }).set('ai',function(card){
            var trigger=_status.event.getTrigger();
            var player=_status.event.player;
            var judging=_status.event.judging;
            var result=trigger.judge(card)-trigger.judge(judging);
            var attitude=get.attitude(player,trigger.player);
            if(attitude==0||result==0) return 0;
            if(attitude>0){
                return result;
            }
            else{
                return -result;
            }
        }).set('judging',trigger.player.judging[0]);
        "step 1"
        if(result.bool){
            player.respond(result.cards,'highlight');
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            player.logSkill('guidao');
            player.$gain2(trigger.player.judging[0]);
            player.gain(trigger.player.judging[0]);
            trigger.player.judging[0]=result.cards[0];
            if(!get.owner(result.cards[0],'judge')){
                trigger.position.appendChild(result.cards[0]);
            }
            game.log(trigger.player,'的判定牌改为',result.cards[0]);
        }
        "step 3"
        game.delay(2);
    },
                ai:{
                    tag:{
                        rejudge:1,
                    },
                },
            },
            "卫境":{
                group:["weijing_sha","weijing_shan"],
                subSkill:{
                    sha:{
                        enable:"chooseToUse",
                        viewAs:{
                            name:"sha",
                        },
                        filterCard:function (){return false},
                        viewAsFilter:function (player){
                if(player.hasSkill('weijing_disable')) return false;
            },
                        selectCard:-1,
                        mark:false,
                        precontent:function (){
                player.addTempSkill('weijing_disable','roundStart');
            },
                        prompt:"视为使用一张杀",
                        ai:{
                            order:function (){
                    var player=_status.event.player;
                    if(!player.hasShan()&&!game.hasPlayer(function(current){
                        return player.canUse('sha',current)&&current.hp==1&&get.effect(current,{name:'sha'},player,player)>0;
                    })){
                        return 0;
                    }
                    return 2.95;
                },
                            skillTagFilter:function (player,tag,arg){
                    if(player.hasSkill('weijing_disable')) return false;
                    if(arg!='use') return false;
                },
                            respondSha:true,
                            basic:{
                                useful:[5,1],
                                value:[5,1],
                            },
                            result:{
                                target:function (player,target){
                            if(player.hasSkill('jiu')&&!target.getEquip('baiyin')){
                                if(get.attitude(player,target)>0){
                                    return -6;
                                }
                                else{
                                    return -3;
                                }
                            }
                            return -1.5;
                        },
                            },
                            tag:{
                                respond:1,
                                respondShan:1,
                                damage:function (card){
                            if(card.nature=='poison') return;
                            return 1;
                        },
                                natureDamage:function (card){
                            if(card.nature) return 1;
                        },
                                fireDamage:function (card,nature){
                            if(card.nature=='fire') return 1;
                        },
                                thunderDamage:function (card,nature){
                            if(card.nature=='thunder') return 1;
                        },
                                poisonDamage:function (card,nature){
                            if(card.nature=='poison') return 1;
                        },
                            },
                        },
                        sub:true,
                    },
                    shan:{
                        enable:"chooseToRespond",
                        viewAs:{
                            name:"shan",
                        },
                        mark:false,
                        filterCard:function (){return false},
                        viewAsFilter:function (player){
                if(player.hasSkill('weijing_disable')) return false;
                if(!lib.filter.cardRespondable({name:'sha'},player)) return false;
            },
                        onrespond:function (event,player){
                player.addTempSkill('weijing_disable','roundStart');
            },
                        selectCard:-1,
                        prompt:"视为使用一张闪",
                        ai:{
                            order:function (){
                    if(player.hasSkill('qingzhong_give')) return 2.95;
                    return 3.15;
                },
                            skillTagFilter:function (player){
                    if(player.hasSkill('weijing_disable')) return false;
                    if(!lib.filter.cardRespondable({name:'sha'},player)) return false;
                },
                            respondShan:true,
                            basic:{
                                useful:[7,2],
                                value:[7,2],
                            },
                        },
                        sub:true,
                    },
                    disable:{
                        mark:true,
                        intro:{
                            content:"本轮已发动",
                        },
                        sub:true,
                    },
                },
            },
            "激昂":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:["shaBefore","juedouBefore"],
                    target:["shaBefore","juedouBefore"],
                },
                filter:function (event,player){
        if(event.card.name=='juedou') return true;
        return get.color(event.card)=='red';
    },
                frequent:true,
                content:function (){
        player.draw();
    },
                ai:{
                    effect:{
                        target:function (card,player,target){
                if(card.name=='sha'&&get.color(card)=='red') return [1,0.6];
            },
                        player:function (card,player,target){
                if(card.name=='sha'&&get.color(card)=='red') return [1,1];
            },
                    },
                },
            },
            "英姿":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"phaseDrawBegin",
                },
                frequent:true,
                content:function (){
        trigger.num++;
    },
                ai:{
                    threaten:1.3,
                },
            },
            "天义":{
                audio:"ext:异界四国:2",
                enable:"phaseUse",
                usable:1,
                filterTarget:function (card,player,target){
        return player!=target&&target.countCards('h')>0;
    },
                filter:function (event,player){
        return player.countCards('h')>0;
    },
                content:function (){
        "step 0"
        player.chooseToCompare(target);
        "step 1"
        if(result.bool){
            player.addTempSkill('tianyi2');
        }
        else{
            player.addTempSkill('tianyi3');
        }
    },
                ai:{
                    order:function (name,player){
            var cards=player.getCards('h');
            if(player.countCards('h','sha')==0){
                return 1;
            }
            for(var i=0;i<cards.length;i++){
                if(cards[i].name!='sha'&&cards[i].number>11&&get.value(cards[i])<7){
                    return 9;
                }
            }
            return get.order({name:'sha'})-1;
        },
                    result:{
                        player:function (player){
                if(player.countCards('h','sha')>0) return 0.6;
                var num=player.countCards('h');
                if(num>player.hp) return 0;
                if(num==1) return -2;
                if(num==2) return -1;
                return -0.7;
            },
                        target:function (player,target){
                var num=target.countCards('h');
                if(num==1) return -1;
                if(num==2) return -0.7;
                return -0.5
            },
                    },
                    threaten:1.3,
                },
            },
            "英魂":{
                audio:"ext:异界四国:2",
                audioname:["sunce"],
                trigger:{
                    player:"phaseBegin",
                },
                filter:function (event,player){
        return player.hp<player.maxHp;
    },
                direct:true,
                content:function (){
        "step 0"
        player.chooseTarget(get.prompt('yinghun'),function(card,player,target){
            return player!=target;
        }).set('ai',function(target){
            var player=_status.event.player;
            if(player.maxHp-player.hp==1&&target.countCards('he')==0){
                return 0;
            }
            if(get.attitude(_status.event.player,target)>0){
                return 10+get.attitude(_status.event.player,target);
            }
            if(player.maxHp-player.hp==1){
                return -1;
            }
            return 1;
        });
        "step 1"
        if(result.bool){
            event.num=player.maxHp-player.hp;
            if(player.countCards('e')>=player.hp){
                event.num=player.maxHp;
            }
            player.logSkill('yinghun',result.targets);
            event.target=result.targets[0];
            if(event.num==1){
                event.directcontrol=true;
            }
            else{
                var str1='摸'+get.cnNumber(event.num,true)+'弃一';
                var str2='摸一弃'+get.cnNumber(event.num,true);
                player.chooseControl(str1,str2,function(event,player){
                    return _status.event.choice;
                }).set('choice',get.attitude(player,event.target)>0?str1:str2);
                event.str=str1;
            }
        }
        else{
            event.finish();
        }
        "step 2"
        if(event.directcontrol||result.control==event.str){
            event.target.draw(event.num);
            event.target.chooseToDiscard(true,'he');
        }
        else{
            event.target.draw();
            event.target.chooseToDiscard(event.num,true,'he');
        }
    },
                ai:{
                    threaten:function (player,target){
            if(target.hp==1||target.countCards('e')>=target.hp) return 2;
            if(target.hp==target.maxHp) return 0.5;
            if(target.hp==2) return 1.5;
            return 0.5;
        },
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                if(target.maxHp<=3) return;
                if(get.tag(card,'damage')){
                    if(target.hp==target.maxHp) return [0,1];
                }
                if(get.tag(card,'recover')&&player.hp>=player.maxHp-1) return [0,0];
            },
                    },
                },
            },
            "枭姬":{
                audio:"ext:异界四国:4",
                trigger:{
                    player:"loseEnd",
                },
                frequent:true,
                filter:function (event,player){
        for(var i=0;i<event.cards.length;i++){
            if(event.cards[i].original=='e') return true;
        }
        return false;
    },
                content:function (){
        var num=0;
        for(var i=0;i<trigger.cards.length;i++){
            if(trigger.cards[i].original=='e') num+=2;
        }
        player.draw(num);
    },
                ai:{
                    noe:true,
                    reverseEquip:true,
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='equip') return [1,3];
            },
                    },
                },
            },
            "豹变":{
                trigger:{
                    player:["phaseBefore","changeHp"],
                },
                forced:true,
                popup:false,
                unique:true,
                derivation:["tiaoxin","paoxiao","xinshensu"],
                content:function (){
        player.removeAdditionalSkill('baobian');
        var list=[];
        if(player.hp<=3){
            list.push('tiaoxin');
        }
        if(player.hp<=2){
            list.push('paoxiao');
        }
        if(player.hp<=1){
            list.push('xinshensu');
        }
        if(list.length){
            player.addAdditionalSkill('baobian',list);
        }
    },
                ai:{
                    maixie:true,
                    effect:{
                        target:function (card,player,target){
                if(get.tag(card,'damage')){
                    if(!target.hasFriend()) return;
                    if(target.hp>=4) return [0,1];
                }
                if(get.tag(card,'recover')&&player.hp>=player.maxHp-1) return [0,0];
            },
                    },
                },
            },
            "慷忾":{
                audio:"ext:异界四国:2",
                trigger:{
                    global:"shaBegin",
                },
                filter:function (event,player){
        return get.distance(player,event.target)<=1;
    },
                check:function (event,player){
        return get.attitude(player,event.target)>=0;
    },
                content:function (){
        "step 0"
        player.draw();
        if(trigger.target!=player){
            player.chooseCard(true,'he','交给'+get.translation(trigger.target)+'一张牌').set('ai',function(card){
                if(get.position(card)=='e') return -1;
                if(card.name=='shan') return 1;
                if(get.type(card)=='equip') return 0.5;
                return 0;
            });
        }
        else{
            event.finish();
        }
        "step 1"
        trigger.target.gain(result.cards,player);
        player.$give(result.cards,trigger.target);
        game.delay();
        event.card=result.cards[0];
        if(get.type(event.card)!='equip') event.finish();
        "step 2"
        if(!trigger.target.isMin()){
            trigger.target.chooseBool('是否装备'+get.translation(event.card)+'？').set('ai',function(){
                var current=_status.event.player.getCards('e',{subtype:get.subtype(_status.event.card)});
                if(current&&current.length){
                    return get.equipValue(event.card)>get.equipValue(current[0]);
                }
                return true;
            }).set('card',event.card);
        }
        else{
            event.finish();
        }
        "step 3"
        if(result.bool){
            trigger.target.equip(event.card);
        }
    },
                ai:{
                    threaten:1.1,
                },
            },
            "天妒":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"judgeEnd",
                },
                frequent:function (event){
        if(event.result.card.name=='du') return false;
        if(get.mode()=='guozhan') return false;
        return true;
    },
                check:function (event){
        if(event.result.card.name=='du') return false;
        return true;
    },
                filter:function (event,player){
        if(get.owner(event.result.card)){
            return false;
        }
        if(event.nogain&&event.nogain(event.result.card)){
            return false;
        }
        return true;
    },
                content:function (){
        player.gain(trigger.result.card);
        player.$gain2(trigger.result.card);
    },
            },
            "奔袭":{
                mod:{
                    globalFrom:function (from,to,distance){
            if(_status.currentPhase==from){
                return distance-from.countUsed();
            }
        },
                    selectTarget:function (card,player,range){
            if(_status.currentPhase==player){
                if(card.name=='sha'&&range[1]!=-1){
                    if(!game.hasPlayer(function(current){
                        return get.distance(player,current)>1;
                    })){
                        range[1]++;
                    }
                }
            }
        },
                },
                ai:{
                    unequip:true,
                    skillTagFilter:function (player){
            if(game.hasPlayer(function(current){
                return get.distance(player,current)>1;
            })){
                return false;
            }
        },
                },
            },
            "伏骑":{
                mod:{
                    wuxieRespondable:function (card,player,target,current){
            if(player!=current&&get.distance(player,current)<=1){
                return false;
            }
        },
                },
                ai:{
                    norespond:true,
                    skillTagFilter:function (player,tag,arg){
            if(tag=='norespond'&&Array.isArray(arg)){
                if(get.distance(arg[1],player)<=1) return true;
            }
            return false;
        },
                },
            },
            "娇恣":{
                trigger:{
                    player:"damageBegin",
                    source:"damageBegin",
                },
                forced:true,
                filter:function (event,player){
        return player.isMaxHandcard(true);
    },
                content:function (){
        trigger.num++;
    },
            },
            "无双":{
                forced:true,
                locked:true,
                group:["wushuang1","wushuang2"],
            },
            "克己":{
                audio:"ext:异界四国:4",
                trigger:{
                    player:"phaseDiscardBefore",
                },
                frequent:function (event,player){
        return !player.needsToDiscard();
    },
                filter:function (event,player){
        return player.countUsed('sha')==0;
    },
                content:function (){
        trigger.cancel();
    },
            },
            "耀武":{
                trigger:{
                    player:"damageEnd",
                },
                priority:1,
                audio:"ext:异界四国:2",
                filter:function (event){
        if(event.card&&(event.card.name=='sha')){
            if(get.color(event.card)=='red') return true;
        }
        return false;
    },
                forced:true,
                check:function (){
        return false;
    },
                content:function (){
        trigger.source.chooseDrawRecover(true);
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(card.name=='sha'&&(get.color(card)=='red')){
                    return [1,-2];
                }
            },
                    },
                },
            },
            "贞烈":{
                audio:"ext:异界四国:2",
                filter:function (event,player){
        return event.player!=player&&event.card&&(event.card.name=='sha'||get.type(event.card)=='trick');
    },
                logTarget:"player",
                check:function (event,player){
        if(get.attitude(player,event.player)>0){
            return false;
        }
        if(get.tag(event.card,'respondSha')){
            if(player.countCards('h',{name:'sha'})==0){
                return true;
            }
        }
        else if(get.tag(event.card,'respondShan')){
            if(player.countCards('h',{name:'shan'})==0){
                return true;
            }
        }
        else if(get.tag(event.card,'damage')){
            if(player.countCards('h')<2) return true;
        }
        else if(event.card.name=='shunshou'&&player.hp>2){
            return true;
        }
        return false;
    },
                priority:10,
                trigger:{
                    target:"useCardToBefore",
                },
                content:function (){
        "step 0"
        player.loseHp();
        "step 1"
        trigger.cancel();
        "step 2"
        if(trigger.player.countCards('he')){
            player.discardPlayerCard(trigger.player,'he',true);
        }
    },
                ai:{
                    expose:0.3,
                },
            },
            "战绝":{
                audio:"ext:异界四国:2",
                enable:"phaseUse",
                filterCard:true,
                selectCard:-1,
                filter:function (event,player){
        if(!player.countCards('h')) return false;
        if(player.storage.zhanjue>=2) return false;
        return true;
    },
                viewAs:{
                    name:"juedou",
                },
                group:["zhanjue2","zhanjue3","zhanjue4"],
                ai:{
                    damage:true,
                    order:1,
                    effect:{
                        player:function (card,player,target){
                if(_status.event.skill=='zhanjue'){
                    if(player.countCards('h')>=3||target.countCards('h')>=3) return 'zeroplayertarget';
                    if(player.countCards('h','tao')) return 'zeroplayertarget';
                    if(target.countCards('h','sha')>1) return 'zeroplayertarget';
                }
            },
                    },
                    basic:{
                        order:5,
                        useful:1,
                        value:5.5,
                    },
                    result:{
                        target:-1.5,
                        player:function (player,target){
                            if(get.damageEffect(target,player,target)>0&&get.attitude(player,target)>0&&get.attitude(target,player)>0){
                                return 0;
                            }
                            var hs1=target.getCards('h','sha');
                            var hs2=player.getCards('h','sha');
                            if(hs1.length>hs2.length+1){
                                return -2;
                            }
                            var hsx=target.getCards('h');
                            if(hsx.length>2&&hs2.length==0&&hsx[0].number<6){
                                return -2;
                            }
                            if(hsx.length>3&&hs2.length==0){
                                return -2;
                            }
                            if(hs1.length>hs2.length&&(!hs2.length||hs1[0].number>hs2[0].number)){
                                return -2;
                            }
                            return -0.5;
                        },
                    },
                    tag:{
                        respond:2,
                        respondSha:2,
                        damage:1,
                    },
                },
            },
            "智愚":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"damageEnd",
                },
                content:function (){
        "step 0"
        player.draw();
        "step 1"
        player.showHandcards();
        "step 2"
        if(!trigger.source) return;
        var cards=player.getCards('h');
        for(var i=1;i<cards.length;i++){
            if(get.color(cards[i])!=get.color(cards[0])) return;
        }
        trigger.source.chooseToDiscard(true);
    },
                ai:{
                    "maixie_defend":true,
                    threaten:0.9,
                },
            },
            "享乐":{
                audio:"ext:异界四国:2",
                trigger:{
                    target:"useCardToBefore",
                },
                forced:true,
                filter:function (event,player){
        return event.card.name=='sha';
    },
                content:function (){
        "step 0"
        var eff=get.effect(player,trigger.card,trigger.player,trigger.player);
        trigger.player.chooseToDiscard('享乐：弃置一张基本牌，否则杀对'+get.translation(player)+'无效',function(card){
            return get.type(card)=='basic';
        }).set('ai',function(card){
            if(_status.event.eff>0){
                return 10-get.value(card);
            }
            return 0;
        }).set('eff',eff);
        "step 1"
        if(result.bool==false){
            trigger.cancel();
        }
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(card.name=='sha'&&get.attitude(player,target)<0){
                    if(_status.event.name=='xiangle') return;
                    var bs=player.getCards('h',{type:'basic'});
                    if(bs.length<2) return 0;
                    if(player.hasSkill('jiu')||player.hasSkill('tianxianjiu')) return;
                    if(bs.length<=3&&player.countCards('h','sha')<=1){
                        for(var i=0;i<bs.length;i++){
                            if(bs[i].name!='sha'&&get.value(bs[i])<7){
                                return [1,0,1,-0.5];
                            }
                        }
                        return 0;
                    }
                    return [1,0,1,-0.5];
                }
            },
                    },
                },
            },
            "天命":{
                audio:"ext:异界四国:2",
                trigger:{
                    target:"shaBegin",
                },
                check:function (event,player){
        var cards=player.getCards('h');
        if(cards.length<=2){
            for(var i=0;i<cards.length;i++){
                if(cards[i].name=='shan'||cards[i].name=='tao') return false;
            }
        }
        return true;
    },
                content:function (){
        "step 0"
        player.chooseToDiscard(2,true,'he');
        player.draw(2);
        var players=game.filterPlayer();
        players.sort(function(a,b){
            return b.hp-a.hp;
        });
        if(players[0].hp>players[1].hp&&players[0]!=player){
            players[0].chooseBool(get.prompt('tianming'));
            event.player=players[0];
        }
        else{
            event.finish();
        }
        "step 1"
        if(result.bool){
            player.chooseToDiscard(2,true,'he');
            player.draw(2);
        }
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(card.name=='sha') return [1,0.5];
            },
                    },
                },
            },
            "黩武":{
                audio:"ext:异界四国:2",
                enable:"phaseUse",
                filter:function (event,player){
        return player.hasSkill('duwu2')==false;
    },
                filterCard:function (){
        if(ui.selected.targets.length) return false;
        return true;
    },
                position:"he",
                selectCard:[1,Infinity],
                complexSelect:true,
                complexCard:true,
                filterTarget:function (card,player,target){
        return target!=player&&get.distance(player,target,'attack')<=1&&ui.selected.cards.length==target.hp;
    },
                check:function (card){
        switch(ui.selected.cards.length){
            case 0:return 7-get.value(card);
            case 1:return 6-get.value(card);
            case 2:return 3-get.value(card);
            default:return 0;
        }
    },
                content:function (){
        "step 0"
        player.addSkill('duwu3');
        target.damage();
        "step 1"
        if(!player.hasSkill('duwu3')){
            player.addSkill('duwu2');
            player.loseHp();
        }
        else{
            player.removeSkill('duwu3');
        }
    },
                ai:{
                    damage:true,
                    order:2,
                    result:{
                        target:function (player,target){
                return get.damageEffect(target,player);
            },
                    },
                    threaten:1.5,
                    expose:0.3,
                },
            },
            "仁德":{
                audio:"ext:异界四国:2",
                group:["rende1"],
                enable:"phaseUse",
                filterCard:true,
                selectCard:[1,Infinity],
                discard:false,
                prepare:"give",
                filterTarget:function (card,player,target){
        return player!=target;
    },
                check:function (card){
        if(ui.selected.cards.length>1) return 0;
        if(ui.selected.cards.length&&ui.selected.cards[0].name=='du') return 0;
        if(!ui.selected.cards.length&&card.name=='du') return 20;
        var player=get.owner(card);
        if(player.hp==player.maxHp||player.storage.rende<0||player.countCards('h')<=1){
            if(ui.selected.cards.length){
                return -1;
            }
            var players=game.filterPlayer();
            for(var i=0;i<players.length;i++){
                if(players[i].hasSkill('haoshi')&&
                    !players[i].isTurnedOver()&&
                    !players[i].hasJudge('lebu')&&
                    get.attitude(player,players[i])>=3&&
                    get.attitude(players[i],player)>=3){
                    return 11-get.value(card);
                }
            }
            if(player.countCards('h')>player.hp) return 10-get.value(card);
            if(player.countCards('h')>2) return 6-get.value(card);
            return -1;
        }
        return 10-get.value(card);
    },
                content:function (){
        target.gain(cards,player);
        if(typeof player.storage.rende!='number'){
            player.storage.rende=0;
        }
        if(player.storage.rende>=0){
            player.storage.rende+=cards.length;
            if(player.storage.rende>=2){
                player.recover();
                player.storage.rende=-1;
            }
        }
    },
                ai:{
                    order:function (skill,player){
            if(player.hp<player.maxHp&&player.storage.rende<2&&player.countCards('h')>1){
                return 10;
            }
            return 1;
        },
                    result:{
                        target:function (player,target){
                if(target.hasSkillTag('nogain')) return 0;
                if(ui.selected.cards.length&&ui.selected.cards[0].name=='du'){
                    if(target.hasSkillTag('nodu')) return 0;
                    return -10;
                }
                if(target.hasJudge('lebu')) return 0;
                var nh=target.countCards('h');
                var np=player.countCards('h');
                if(player.hp==player.maxHp||player.storage.rende<0||player.countCards('h')<=1){
                    if(nh>=np-1&&np<=player.hp&&!target.hasSkill('haoshi')) return 0;
                }
                return Math.max(1,5-nh);
            },
                    },
                    effect:{
                        target:function (card,player,target){
                if(player==target&&get.type(card)=='equip'){
                    if(player.countCards('e',{subtype:get.subtype(card)})){
                        var players=game.filterPlayer();
                        for(var i=0;i<players.length;i++){
                            if(players[i]!=player&&get.attitude(player,players[i])>0){
                                return 0;
                            }
                        }
                    }
                }
            },
                    },
                    threaten:0.8,
                },
            },
            "旋风":{
                audio:"xuanfeng",
                trigger:{
                    player:["loseEnd","phaseDiscardEnd"],
                },
                direct:true,
                filter:function (event,player){
        if(event.name=='phaseDiscard'){
            return event.cards&&event.cards.length>1
        }
        else{
            for(var i=0;i<event.cards.length;i++){
                if(event.cards[i].original=='e') return true;
            }
        }
        return false;
    },
                content:function (){
        "step 0"
        event.num=2
         "step 1"
       
        
        player.chooseTarget(get.prompt('ol_xuanfeng'),function(card,player,target){
            if(player==target) return false;
            return target.countCards('he');
        }).set('ai',function(target){
            return -get.attitude(_status.event.player,target);
        });
        "step 2"
        if(result.bool){
            player.logSkill('ol_xuanfeng',result.targets);
            event.targets=result.targets
            player.discardPlayerCard(event.targets[0],'he',true);
            
        event.num--;
                    if(event.num>0){
                       
                        event.goto(1);
                    }}
        
    },
                ai:{
                    effect:{
                        target:function (card,player,target,current){
                if(get.type(card)=='equip') return [1,3];
            },
                    },
                    noe:true,
                },
            },
            "制衡":{
                audio:"zhiheng",
                enable:"phaseUse",
                alter:true,
                usable:1,
                position:"he",
                filterCard:true,
                selectCard:[1,Infinity],
                check:function (card){
        var player=_status.event.player;
        if(get.is.altered('xinzhiheng')&&get.position(card)=='h'&&!player.countCards('h',function(card){
            return get.value(card)>=8;
        })){
            return 8-get.value(card);
        }
        return 6-get.value(card)
    },
                delay:0,
                content:function (){
        'step 0'
        if(!player.hasSkill('xinzhiheng_delay')) game.delayx();
        'step 1'
        player.draw(cards.length);
    },
                group:"xinzhiheng_draw",
                subSkill:{
                    draw:{
                        trigger:{
                            player:"loseEnd",
                        },
                        silent:true,
                        filter:function (event,player){
                if(event.getParent(2).skill!='xinzhiheng') return false;
                if(!get.is.altered('xinzhiheng')) return false;
                if(player.countCards('h')) return false;
                for(var i=0;i<event.cards.length;i++){
                    if(event.cards[i].original=='h') return true;
                }
                return false;
            },
                        content:function (){
                player.draw();
                player.addTempSkill('xinzhiheng_delay','xinzhihengAfter');
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                    delay:{
                        sub:true,
                    },
                },
                ai:{
                    order:1,
                    result:{
                        player:1,
                    },
                    threaten:1.55,
                },
            },
            "强识":{
                audio:"ext:异界四国:2",
                trigger:{
                    player:"phaseUseBegin",
                },
                direct:true,
                filterTarget:function (card,player,target){
        return target!=player&&target.countCards('h')>0;
    },
                content:function (){
        'step 0'
        player.chooseTarget(get.prompt('qiangzhi'),function(card,player,target){
            return target!=player&&target.countCards('h')>0;
        }).set('ai',function(){
            return Math.random();
        });
        'step 1'
        if(result.bool){
            var target=result.targets[0];
            player.logSkill('qiangzhi',target);
            var card=target.getCards('h').randomGet();
            player.showCards(card);
            player.storage.qiangzhi=get.type(card,'trick');
            game.addVideo('storage',player,['qiangzhi',player.storage.qiangzhi]);
            player.markSkill('qiangzhi');
        }
    },
                intro:{
                    content:function (type){
            return get.translation(type)+'牌';
        },
                },
                group:["qiangzhi2","qiangzhi3"],
                ai:{
                    order:11,
                    result:{
                        player:1,
                    },
                },
            },
            "骁果":{
                audio:"ext:异界四国:2",
                trigger:{
                    global:"phaseEnd",
                },
                filter:function (event,player){
        return event.player.isAlive()&&event.player!=player&&player.countCards('h',{type:'basic'});
    },
                direct:true,
                content:function (){
        "step 0"
        var nono=(Math.abs(get.attitude(player,trigger.player))<3);
        if(get.damageEffect(trigger.player,player,player)<=0){
            nono=true;
        }
        var next=player.chooseToDiscard('弃置一张装备牌并令'+get.translation(player)+'摸一张牌，或受到一点伤害',get.prompt('xiaoguo',trigger.player),{type:'basic'});
        next.set('ai',function(card){
            if(_status.event.nono) return 0;
            return 8-get.useful(card);
        });
        next.set('logSkill',['xiaoguo',trigger.player]);
        next.set('nono',nono);
        "step 1"
        if(result.bool){
            var nono=(get.damageEffect(trigger.player,player,trigger.player)>=0);
            trigger.player.chooseToDiscard('he',{type:'equip'}).set('ai',function(card){
                if(_status.event.nono){
                    return 0;
                }
                if(_status.event.player.hp==1) return 10-get.value(card);
                return 9-get.value(card);
            }).set('nono',nono);
        }
        else{
            event.finish();
        }
        "step 2"
        if(result.bool){
            player.draw();
        }
        else{
            trigger.player.damage();
        }
    },
                ai:{
                    expose:0.3,
                    threaten:1.3,
                },
            },
            "烈弓":{
                mod:{
                    targetInRange:function (card,player,target){
            if(card.name=='sha'&&card.number){
                if(get.distance(player,target)<=card.number) return true;
            }
        },
                },
                audio:"liegong",
                trigger:{
                    player:"shaBegin",
                },
                logTarget:"target",
                check:function (event,player){
        return get.attitude(player,event.target)<=0;
    },
                filter:function (event,player){
        if(event.target.countCards('h')<=player.countCards('h')) return true;
        if(event.target.hp<=player.hp) return true;
        return false;
    },
                content:function (){
        if(trigger.target.countCards('h')<=player.countCards('h')) trigger.directHit=true;
        if(trigger.target.hp>=player.hp) player.addTempSkill('xinliegong2','shaAfter');
    },
                ai:{
                    threaten:0.5,
                },
            },
            "战意":{
                enable:"phaseUse",
                usable:1,
                filterCard:true,
                position:"he",
                check:function (card){
        var player=_status.event.player;
        if(player.hp<3) return 0;
        var type=get.type(card,'trick');
        if(type=='trick'){
            return 6-get.value(card);
        }
        else if(type=='equip'){
            if(player.hasSha()&&game.hasPlayer(function(current){
                return (player.canUse('sha',current)&&
                    get.attitude(player,current)<0&&
                    get.effect(current,{name:'sha'},player,player)>0)
            })){
                return 6-get.value(card);
            }
        }
        return 0;
    },
                content:function (){
        player.loseHp();
        switch(get.type(cards[0],'trick')){
            case 'basic':player.addTempSkill('zhanyi_basic');break;
            case 'equip':player.addTempSkill('zhanyi_equip');break;
            case 'trick':player.addTempSkill('zhanyi_trick');player.draw(2);break;
        }
    },
                ai:{
                    order:9.1,
                    result:{
                        player:1,
                    },
                },
            },
            "蒺藜":{
                subSkill:{
                    count:{
                        trigger:{
                            player:["useCard","respond"],
                        },
                        silent:true,
                        priority:1,
                        content:function (){
                player.storage.gzjili++;
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                    init:{
                        trigger:{
                            global:"phaseBefore",
                        },
                        silent:true,
                        content:function (){
                player.storage.gzjili=0;
            },
                        sub:true,
                        forced:true,
                        popup:false,
                    },
                },
                group:["gzjili_count","gzjili_init"],
                trigger:{
                    player:["useCard","respond"],
                },
                frequent:true,
                filter:function (event,player){
        return player.storage.gzjili==player.getAttackRange();
    },
                content:function (){
        player.draw(player.getAttackRange());
    },
                ai:{
                    threaten:1.8,
                },
            },
        },
        translate:{
            "诈降":"诈降",
            "诈降_info":"锁定技 每当你失去1点体力后，你摸三张牌。然后若此时是你的出牌阶段，则直到回合结束，你使用红色【杀】无距离限制且不能被【闪】响应，你可以额外使用一张【杀】。",
            "强袭":"强袭",
            "强袭_info":"出牌阶段各限一次，你可以选择一项：1. 失去一点体力并对你攻击范围内的一名其他角色造成一点伤害；2. 弃置一张装备牌并对你攻击范围内的一名其他角色造成一点伤害 ",
            "连营":"连营",
            "连营_info":"当你失去最后的手牌时，你可以令至多X名角色各摸一张牌（X为你此次失去的手牌数）。",
            "谦逊":"谦逊",
            "谦逊_info":"每当一张延时类锦囊牌或其他角色使用的普通锦囊牌生效时，若你是此牌的唯一目标，你可以将所有手牌置于你的武将牌上，若如此做，此回合结束时，你获得你武将牌上的所有牌。",
            "青囊":"青囊",
            "青囊_info":"出牌阶段，你可以弃置一张手牌令一名角色回复一点体力，每阶段限一次",
            "急救":"急救",
            "急救_info":"回合外，你可以将一张红色牌当[桃]使用",
            "苦肉":"苦肉",
            "苦肉_info":"出牌阶段，你可以流失一点体力并摸两张牌",
            "龙吟":"龙吟",
            "龙吟_info":"每当一名角色在其出牌阶段使用【杀】时，你可弃置一张牌令此【杀】不计入出牌阶段使用次数，若此【杀】为红色，你摸一张牌",
            "马术":"马术",
            "马术_info":"锁定技，你的进攻距离+1",
            "铁骑":"铁骑",
            "铁骑_info":"当你使用一张[杀]时，可进行一次判定，若为红色则此[杀]不可闪避",
            "安国":"安国",
            "安国_info":"出牌阶段限一次，你可以选择一名其他角色，若其手牌数为全场最少，其摸一张牌；体力值为全场最低，回复1点体力；装备区内牌数为全场最少，随机使用一张装备牌。然后若该角色有未执行的效果且你满足条件，你执行之。",
            "奋迅":"奋迅",
            "奋迅_info":"出牌阶段限一次，你可以弃置一张牌并选择一名其他角色，然后本回合你计算与其的距离视为1",
            "短兵":"短兵",
            "短兵_info":"你使用【杀】可以多选择一名距离为1的角色为目标",
            "狂骨":"狂骨",
            "狂骨_info":"当你对距离1以内的一名角色造成1点伤害后，你可以回复1点体力或摸一张牌",
            "武圣":"武圣",
            "武圣_info":"你可以将一张红色牌当[杀]使用",
            "奇谋":"奇谋",
            "奇谋_info":"限定技，出牌阶段，你可以失去任意点体力，然后直到回合结束，你的进攻距离+X，且你可以多使用X张【杀】（X为你失去的体力值）",
            "陷阵":"陷阵",
            "陷阵_info":"出牌阶段，你可以与一名角色拼点。若你赢，你获得以下技能直到回合结束：无视与该角色的距离；无视防具且可使用任意数量的【杀】。若你没赢，你不能使用【杀】直到回合结束。每回合限一次",
            "禁酒":"禁酒",
            "禁酒_info":"锁定技，你的【酒】均视为【杀】",
            "天辩":"天辩",
            "天辩_info":"你拼点时，可以改为用牌堆顶的一张牌进行拼点；当你拼点的牌亮出后，若此牌花色为红桃，则点数视为K",
            "遗计":"遗计",
            "遗计_info":"每当你受到一点伤害，可以观看牌堆顶的两张牌，并将其交给任意1~2名角色",
            "龙胆":"龙胆",
            "龙胆_info":"你可以将[杀]当[闪]，或[闪]当[杀]使用或打出",
            "冲阵":"冲阵",
            "冲阵_info":"每当你发动“龙胆”使用或打出一张手牌时，你可以立即获得对方的一张手牌。",
            "咆哮":"咆哮",
            "咆哮_info":"出牌阶段，你使用[杀]无数量限制",
            "离魂":"离魂",
            "离魂_info":"出牌阶段，你可以弃置一张牌并将你的武将牌翻面，若如此做，你指定一名男性角色，获得其所有手牌。出牌阶段结束时，你需为该角色每一点体力分配给其一张牌。每回合限一次。",
            "据守":"据守",
            "据守_info":"结束阶段，你可以翻面并摸四张牌，然后弃置一张手牌，若以此法弃置的是装备牌，则你改为使用之",
            "空城":"空城",
            "空城_info":"锁定技，当你没有手牌时，不能成为[杀]或[决斗]的目标",
            "极奢":"极奢",
            "极奢_info":"出牌阶段，若你的手牌上限大于0，你可以摸一张牌，然后你本回合的手牌上限-1。结束阶段开始时，若你没有手牌，则你可以横置至多X名角色的武将牌（X为你的体力值）",
            "裸衣":"裸衣",
            "裸衣_info":"你可以跳过摸牌阶段，然后展示牌堆顶的三张牌，获得其中的基本牌、武器牌和【决斗】，若如此做，直到你的下回合开始，你为伤害来源的【杀】或【决斗】造成的伤害+1。",
            "闭月":"闭月",
            "闭月_info":"结束阶段，你可以摸一张牌",
            "庸肆":"庸肆",
            "庸肆_info":"锁定技，摸牌阶段，你令额定摸牌数为X(X为势力数);弃牌阶段开始时，你选择一项：1.弃置一张牌;2.失去1点体力",
            "伤势":"伤势",
            "伤势_info":"锁定技，当你的手牌数小于X时，你立即将手牌补至X张（X为你已损失的体力值且最多为3）",
            "再起":"再起",
            "再起_info":"摸牌阶段，若你已受伤，你可以改为展示牌堆顶的X张牌，X为你已损失的体力值，其中每有一张♥牌，你回复1点体力，然后弃掉这些♥牌，将其余的牌收入手牌。",
            "崩坏":"崩坏",
            "崩坏_info":"结束阶段，若你的体力不是全场最少的(或之一)，你须减1点体力或体力上限。",
            "肉林":"肉林",
            "肉林_info":"你对女性角色、女性角色对你使用【杀】时，都需连续使用两张【闪】才能抵消。",
            "奇策":"奇策",
            "奇策_info":"出牌阶段，你可以将所有的手牌（至少一张）当做任意一张通常性锦囊牌使用，每阶段限一次。",
            "恢拓":"恢拓",
            "恢拓_info":"每当你受到伤害后，你可以令一名角色进行一次判定，若结果为红色，该角色回复1点体力；若结果为黑色，该角色摸X张牌（X为此次伤害的伤害数）",
            "巨象":"巨象",
            "巨象_info":"南蛮入侵】对你无效；若其他角色使用的【南蛮入侵】在结算完时进入弃牌堆，你立即获得它。",
            "烈刃":"烈刃",
            "烈刃_info":"你每使用【杀】造成一次伤害，可与受到该伤害的角色拼点；若你赢，你获得对方的一张牌。",
            "奇袭":"奇袭",
            "奇袭_info":"你可以将一张黑色牌当[过河拆桥]使用",
            "洛神":"洛神",
            "洛神_info":"准备阶段，你可以进行一定判定，若为黑色则可以继续判定，直到出现红色。然后你获得所有黑色的判定牌",
            "鬼才":"鬼才",
            "鬼才_info":"在任意角色的判定牌生效前，你可以打出一张手牌代替之",
            "矢北":"矢北",
            "矢北_info":"锁定技，当你受到伤害后：若此伤害是你本回合第一次受到伤害，则你回复1点体力；若不是你本回合第一次受到伤害，则你失去1点体力。",
            "清弦":"清弦",
            "清弦_info":"当你受到伤害/回复体力后，你可以令伤害来源/一名其他角色执行一项：失去1点体力，随机使用一张装备牌；回复1点体力，弃置一张装备牌。若其以此法使用或弃置的牌为梅花，你回复1点体力",
            "酒诗":"酒诗",
            "酒诗_info":"若你的武将牌正面朝上，你可以(在合理的时机)将你的武将牌翻面来视为使用一张【酒】;当你的武将牌背面朝上时你受到伤害，你可在伤害结算后将之翻回正面。",
            "解围":"解围",
            "解围_info":"你可以将装备区里的牌当【无懈可击】使用；当你从背面翻至正面时，你可以弃置一张牌，然后移动场上的一张牌",
            "奸雄":"奸雄",
            "奸雄_info":"你可以立即获得对你造成伤害的牌",
            "刚烈":"刚烈",
            "刚烈_info":"每当你受到一次伤害，可进行一次判定，若结果不为红桃，则伤害来源须弃置两张手牌或受到来自你的一点伤害",
            "雷击":"雷击",
            "雷击_info":"每当你使用或打出一张【闪】，可令任意一名角色进行一次判定，若结果为梅花，其受到一点雷电伤害，然后你回复一点体力；若结果为黑桃，其受到两点雷电伤害",
            "鬼道":"鬼道",
            "鬼道_info":"任意一名角色的判定生效前，你可以打出一张黑色牌替换之",
            "卫境":"卫境",
            "卫境_info":"每轮限一次，你可以在需要使用【杀】或【闪】时，视为使用一张【杀】或【闪】。",
            "激昂":"激昂",
            "激昂_info":"每当你使用（指定目标后）或被使用（成为目标后）一张【决斗】或红色的【杀】时，你可以摸一张牌。",
            "英姿":"英姿",
            "英姿_info":"摸牌阶段，你可以额外摸一张牌",
            "天义":"天义",
            "天义_info":"出牌阶段，你可以和一名角色拼点，若你赢，你获得以下技能直到回合结束：攻击范围无限；可额外使用一张【杀】；使用【杀】时可额外指定一个目标，若你没赢，你不能使用【杀】直到回合结束。每回合限一次。",
            "英魂":"英魂",
            "英魂_info":"准备阶段开始时，若你已受伤，你可令一名其他角色执行一项：摸X张牌，然后弃置一张牌；或摸一张牌，然后弃置X张牌（X为你已损失的体力值，若你装备区里牌的数量不小于你的体力值，则X改为你的体力上限）",
            "枭姬":"枭姬",
            "枭姬_info":"每当你失去一张装备牌，可以摸两张牌",
            "豹变":"豹变",
            "豹变_info":"锁定技，若你的体力值为3或更少，你视为拥有技能“挑衅”；若你的体力值为2或更少；你视为拥有技能“咆哮”；若你的体力值为1，你视为拥有技能“神速”。",
            "慷忾":"慷忾",
            "慷忾_info":"每当你距离1以内的角色成为杀的目标后，你可以摸一张牌。若如此做，你交给其一张牌并展示之，若该牌为装备牌，该角色可以使用此牌。",
            "天妒":"天妒",
            "天妒_info":"你可以立即获得你的判定牌",
            "奔袭":"奔袭",
            "奔袭_info":"锁定技，在你的回合内，你每使用一次牌后，你的进攻距离+1，直到回合结束；你的回合内，若你与所有角色的距离均为1，你无视其他角色的防具，且你使用的【杀】可额外指定一个目标",
            "伏骑":"伏骑",
            "伏骑_info":"锁定技，与你距离为1的其他角色不能使用或打出牌响应你使用的牌",
            "娇恣":"娇恣",
            "娇恣_info":"锁定技，若你的手牌数是全场唯一最多的，你造成或受到的伤害均+1",
            "无双":"无双",
            "无双_info":"锁定技，你使用的【杀】或【决斗】需要两张【闪】或【杀】响应",
            "克己":"克己",
            "克己_info":"若你在出牌阶段没有使用[杀]，则可跳过弃牌阶段",
            "耀武":"耀武",
            "耀武_info":"锁定技，当任意一名角色使用红色【杀】对你造成伤害时，该角色回复1点体力或摸一张牌。",
            "贞烈":"贞烈",
            "贞烈_info":"每当你成为其他角色的卡牌的目标时，你可以流失一点体力取消之，然后弃置对方一张牌",
            "战绝":"战绝",
            "战绝_info":"出牌阶段，你可以将所有手牌当【决斗】使用，结算后你和以此法受到伤害的角色各摸一张牌。若你在同一阶段内以此法摸了两张或更多的牌，则此技能失效直到回合结束",
            "智愚":"智愚",
            "智愚_info":"每当你受到一次伤害后，你可以摸一张牌，然后展示所有手牌，若颜色均相同，伤害来源弃置一张手牌。",
            "享乐":"享乐",
            "享乐_info":"锁定技，当其他玩家使用【杀】指定你为目标时，需额外弃掉一张基本牌，否则该【杀】对你无效。",
            "天命":"天命",
            "天命_info":"当你成为【杀】的目标时，你可以弃置两张牌(不足则全弃，无牌则不弃)，然后摸两张牌;若此时全场体力值最多的角色仅有一名(且不是你)，该角色也可以如此做。",
            "黩武":"黩武",
            "黩武_info":"出牌阶段，你可以弃置X张牌对你攻击范围内的一名其他角色造成1点伤害(X为该角色的体力值)。若你以此法令该角色进入濒死状态，则濒死状态结算后你失去1点体力，且本回合不能再发动黩武。",
            "仁德":"仁德",
            "仁德_info":"出牌阶段，你可以将任意手牌送给其他角色，若送出的手牌不少于两张，你回复一点体力",
            "旋风":"旋风",
            "旋风_info":"当你失去装备区里的牌时，或于弃牌阶段弃置了两张或更多的手牌后，你可以依次弃置一至两名其他角色的共计两张牌。",
            "制衡":"制衡",
            "制衡_info":"出牌阶段限1次，你可以弃置任意张牌并摸等量的牌",
            "强识":"强识",
            "强识_info":"出牌阶段开始时，你可以展示一名其他角色的一张手牌。若如此做，每当你于此阶段内使用与此牌类别相同的牌时，你可以摸一张牌。",
            "骁果":"骁果",
            "骁果_info":"其他角色的结束阶段开始时，你可以弃置一张基本牌，令该角色选择一项：1.弃置一张装备牌并令你摸一张牌；2.受到你对其造成的1点伤害。",
            "烈弓":"烈弓",
            "烈弓_info":"你使用【杀】可以选择你距离不大于此【杀】点数的角色为目标；当你使用【杀】指定一个目标后，你可以根据下列条件执行相应的效果：1.其手牌数小于等于你的手牌数，此【杀】不可被【闪】响应 2.其体力值大于等于你的体力值，此【杀】伤害+1",
            "战意":"战意",
            "战意_info":"出牌阶段限一次，你可以弃置一张牌并失去1点体力，然后根据你弃置的牌获得以下效果直到回合结束：基本牌，你可以将一张基本牌当作杀、酒或桃使用；锦囊牌，摸两张牌且你使用的牌无距离限制；装备牌，你使用【杀】指定目标角色后，其弃置两张牌",
            "蒺藜":"蒺藜",
            "蒺藜_info":"当你于一回合内使用或打出第X张牌时，你可以摸X张牌（X为你的攻击范围）。",
        },
    },
    intro:"存在于异世界的武将",
    author:"谜之仙人",
    diskURL:"",
    forumURL:"",
    version:"1.0",
},files:{"character":["王华.jpg","魏羽.jpg","孙仁.jpg","嵇授获.jpg","夏侯嘉.jpg","曹侯淳.jpg","刘恪.jpg","诸昏.jpg","夏侯昂.jpg","吴义.jpg","凌权.jpg","朱盖.jpg","郭佗.jpg","刘亮.jpg","黄志.jpg","祝宓.jpg","吕瑜.jpg","孟康.jpg","太史宓.jpg","典盖.jpg","孙瑜慈.jpg","黄奉.jpg","乐仁.jpg","董获.jpg","关松.jpg","曹智仁.jpg","许蝉.jpg","华异.jpg","甘逊.jpg","貂仁.jpg","高宓.jpg","刘攸.jpg","甄懿.jpg","袁华.jpg","吕羽.jpg","赵飞.jpg","张芝.jpg","孙华.jpg","马平.jpg","沮康.jpg","荀睿.jpg"],"card":[],"skill":[]}}})